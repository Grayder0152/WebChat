var cl_is_ie = ( /msie/i.test(navigator.userAgent) && !/opera/i.test(navigator.userAgent) );var cl_active = false;var cl_calendar = null;var cl_calendar_cell = null;var cl_field = null;var cl_date = null;var cl_date_behind = null;var cl_timeout = null;var cl_ctool = null;var cl_el_years = null;var cl_el_months = null;var cl_el_head = null;var cl_el_head_tbody = null;var cl_el_head_td = null;var cl_el_days = null;var cl_el_days_tbody = null;var cl_msg_today = "Today";var cl_msg_months = ["January","February","March","April","May","June","July","August","September","October","November","December"];var cl_msg_smonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var cl_msg_wdays = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];try { if ( msg_today ) cl_msg_today = msg_today; } catch (ex) {}for ( var i=0; i<12; i++ ) { cl_msg_months[i] = eval("msg_m"+i); cl_msg_smonths[i] = eval("msg_ms"+i); }for ( var i=0; i<7; i++ ) { cl_msg_wdays[i] = eval("msg_w"+i); }function cl_show ( field, e ) {e || (e = window.event);mn_hintout();if ( !cl_calendar ) cl_calendar = document.getElementById("calendar");if ( !cl_calendar_cell ) cl_calendar_cell = document.getElementById("calendar-cell");if ( !cl_el_years ) cl_el_years = document.getElementById("calendar-y");if ( !cl_el_months ) cl_el_months = document.getElementById("calendar-m");cl_add_event(document, "mousedown", cl_check_outclick);if (window.formframe) cl_add_event(formframe.document, "mousedown", cl_check_outclick);cl_field = field;cl_date = cl_parse_date( cl_field.value );cl_draw_calendar();cl_draw_date(cl_date);var obj = ( e.target ) ? e.target : e.srcElement;var ipos = (window.formframe) ? formframe.fr_get_obj_pos( obj ) : fr_get_obj_pos( obj );var fpos = (window.formframe) ? mn_get_obj_pos(mn_get_obj('formframe')) : [0,0];var x = ipos[0] + fpos[0] + 6 + obj.offsetWidth - cl_calendar.offsetWidth;if ( cl_is_ie ) x += 1;var y = ipos[1] + fpos[1] + obj.offsetHeight - 1;cl_calendar.style.left = x;cl_calendar.style.top = y;cl_calendar.style.visibility = "visible";cl_active = true;}function cl_hide () {if ( !cl_calendar ) cl_calendar = document.getElementById("calendar");cl_remove_event(document, "mousedown", cl_check_outclick);if (window.formframe) cl_remove_event(formframe.document, "mousedown", cl_check_outclick);cl_calendar.style.visibility = "hidden";cl_active = false;}function cl_show_rep ( field, e ) {e || (e = window.event);if ( !cl_calendar ) cl_calendar = document.getElementById("calendar");if ( !cl_calendar_cell ) cl_calendar_cell = document.getElementById("calendar-cell");if ( !cl_el_years ) cl_el_years = document.getElementById("calendar-y");if ( !cl_el_months ) cl_el_months = document.getElementById("calendar-m");cl_add_event(document, "mousedown", cl_check_outclick_rep);cl_add_event(document, "mousedown", cl_check_outclick_rep);cl_field = field;cl_date = cl_parse_date( cl_field.value );cl_draw_calendar_rep();cl_draw_date_rep(cl_date);var obj = ( e.target ) ? e.target : e.srcElement;var ipos = mn_get_obj_pos( obj );var fpos = mn_get_obj_pos(mn_get_obj('frm'));var x = ipos[0] + fpos[0] + 6 + obj.offsetWidth - cl_calendar.offsetWidth;if ( cl_is_ie ) x += 1;var y = ipos[1] +  obj.offsetHeight - 1;cl_calendar.style.left = x;cl_calendar.style.top = y;cl_calendar.style.visibility = "visible";cl_active = true;}function cl_hide_rep () {if ( !cl_calendar ) cl_calendar = document.getElementById("calendar");cl_remove_event(document, "mousedown", cl_check_outclick_rep);cl_remove_event(document, "mousedown", cl_check_outclick_rep);cl_calendar.style.visibility = "hidden";cl_active = false;}function cl_draw_calendar () {if ( cl_el_head ) return;cl_el_head = document.createElement("table");cl_el_head.className = "cl-head";cl_calendar_cell.appendChild(cl_el_head);cl_el_head_tbody = document.createElement("tbody");cl_el_head.appendChild(cl_el_head_tbody);var cl_el_head_tr = document.createElement("tr");cl_el_head_tbody.appendChild(cl_el_head_tr);cl_el_head_td = document.createElement("td");cl_el_head_td.innerHTML = "&nbsp;";cl_el_head_tr.appendChild(cl_el_head_td);for ( var i=0; i<12; i++ ) {var cl_el_div = document.createElement("div");cl_el_div.id = "ycombo"+i;cl_el_div.className = ( i%2 == 0 ) ? "cl-ym-div" : "cl-ym-diveven";cl_el_div.innerHTML = "y " + i;cl_add_event(cl_el_div, "mouseover", cl_combo_mouseover);cl_add_event(cl_el_div, "mouseout", cl_combo_mouseout);cl_add_event(cl_el_div, "mouseup", cl_combo_mouseup);cl_el_years.appendChild(cl_el_div);cl_el_div = document.createElement("div");cl_el_div.id = "mcombo"+i;cl_el_div.className = ( i%2 == 0 ) ? "cl-ym-div" : "cl-ym-diveven";cl_el_div.innerHTML = "m " + i;cl_add_event(cl_el_div, "mouseover", cl_combo_mouseover);cl_add_event(cl_el_div, "mouseout", cl_combo_mouseout);cl_add_event(cl_el_div, "mouseup", cl_combo_mouseup);cl_el_months.appendChild(cl_el_div);}cl_el_days = document.createElement("table");cl_el_days.className = "cl-days";cl_calendar_cell.appendChild(cl_el_days);cl_el_days_tbody = document.createElement("tbody");cl_el_days.appendChild(cl_el_days_tbody);var cl_el_tool_tr = document.createElement("tr");cl_el_days_tbody.appendChild(cl_el_tool_tr);var toolcontent = ["&lt;&lt;","&lt;",cl_msg_today,"&gt;","&gt;&gt;"];for ( var i=0; i<5; i++ ) {var cl_el_tool_td = document.createElement("td");cl_el_tool_td.className = "cl-tool-td";cl_el_tool_td.id = "cl-tool" + i;cl_el_tool_td.setAttribute("unselectable", true);cl_el_tool_td.innerHTML = toolcontent[i];if ( i == 2 ) cl_el_tool_td.colSpan = 3;if ( i == 4 ) cl_el_tool_td.style.borderRightWidth = 0;cl_add_event(cl_el_tool_td, "mouseover", cl_tool_mouseover);cl_add_event(cl_el_tool_td, "mouseout", cl_tool_mouseout);cl_add_event(cl_el_tool_td, "mousedown", cl_tool_mousedown);cl_add_event(cl_el_tool_td, "mouseup", cl_tool_mouseup);cl_el_tool_tr.appendChild(cl_el_tool_td);}for ( var i=0; i<7; i++ ) {var cl_el_days_tr = document.createElement("tr");if ( i == 0 ) cl_el_days_tr.className = "cl-dayst-tr";cl_el_days_tbody.appendChild(cl_el_days_tr);for ( var j=0; j<7; j++ ) {var cl_el_days_td = document.createElement("td");if ( j == 6 ) cl_el_days_td.style.borderRightWidth = 0;cl_el_days_td.innerHTML = ( i == 0 ) ? cl_msg_wdays[j] : "&nbsp;";if ( i != 0 ) {cl_add_event(cl_el_days_td, "mouseover", cl_days_mouseover);cl_add_event(cl_el_days_td, "mouseout", cl_days_mouseout);cl_add_event(cl_el_days_td, "mousedown", cl_days_mousedown);}cl_el_days_tr.appendChild(cl_el_days_td);}}}function cl_draw_calendar_rep () {if ( cl_el_head ) return;cl_el_head = document.createElement("table");cl_el_head.className = "cl-head";cl_calendar_cell.appendChild(cl_el_head);cl_el_head_tbody = document.createElement("tbody");cl_el_head.appendChild(cl_el_head_tbody);var cl_el_head_tr = document.createElement("tr");cl_el_head_tbody.appendChild(cl_el_head_tr);cl_el_head_td = document.createElement("td");cl_el_head_td.innerHTML = "&nbsp;";cl_el_head_tr.appendChild(cl_el_head_td);for ( var i=0; i<12; i++ ) {var cl_el_div = document.createElement("div");cl_el_div.id = "ycombo"+i;cl_el_div.className = ( i%2 == 0 ) ? "cl-ym-div" : "cl-ym-diveven";cl_el_div.innerHTML = "y " + i;cl_add_event(cl_el_div, "mouseover", cl_combo_mouseover);cl_add_event(cl_el_div, "mouseout", cl_combo_mouseout);cl_add_event(cl_el_div, "mouseup", cl_combo_mouseup_rep);cl_el_years.appendChild(cl_el_div);cl_el_div = document.createElement("div");cl_el_div.id = "mcombo"+i;cl_el_div.className = ( i%2 == 0 ) ? "cl-ym-div" : "cl-ym-diveven";cl_el_div.innerHTML = "m " + i;cl_add_event(cl_el_div, "mouseover", cl_combo_mouseover);cl_add_event(cl_el_div, "mouseout", cl_combo_mouseout);cl_add_event(cl_el_div, "mouseup", cl_combo_mouseup_rep);cl_el_months.appendChild(cl_el_div);}cl_el_days = document.createElement("table");cl_el_days.className = "cl-days";cl_calendar_cell.appendChild(cl_el_days);cl_el_days_tbody = document.createElement("tbody");cl_el_days.appendChild(cl_el_days_tbody);var cl_el_tool_tr = document.createElement("tr");cl_el_days_tbody.appendChild(cl_el_tool_tr);var toolcontent = ["&lt;&lt;","&lt;",cl_msg_today,"&gt;","&gt;&gt;"];for ( var i=0; i<5; i++ ) {var cl_el_tool_td = document.createElement("td");cl_el_tool_td.className = "cl-tool-td";cl_el_tool_td.id = "cl-tool" + i;cl_el_tool_td.setAttribute("unselectable", true);cl_el_tool_td.innerHTML = toolcontent[i];if ( i == 2 ) cl_el_tool_td.colSpan = 3;if ( i == 4 ) cl_el_tool_td.style.borderRightWidth = 0;cl_add_event(cl_el_tool_td, "mouseover", cl_tool_mouseover);cl_add_event(cl_el_tool_td, "mouseout", cl_tool_mouseout);cl_add_event(cl_el_tool_td, "mousedown", cl_tool_mousedown_rep);cl_add_event(cl_el_tool_td, "mouseup", cl_tool_mouseup_rep);cl_el_tool_tr.appendChild(cl_el_tool_td);}for ( var i=0; i<7; i++ ) {var cl_el_days_tr = document.createElement("tr");if ( i == 0 ) cl_el_days_tr.className = "cl-dayst-tr";cl_el_days_tbody.appendChild(cl_el_days_tr);for ( var j=0; j<7; j++ ) {var cl_el_days_td = document.createElement("td");if ( j == 6 ) cl_el_days_td.style.borderRightWidth = 0;cl_el_days_td.innerHTML = ( i == 0 ) ? cl_msg_wdays[j] : "&nbsp;";if ( i != 0 ) {cl_add_event(cl_el_days_td, "mouseover", cl_days_mouseover);cl_add_event(cl_el_days_td, "mouseout", cl_days_mouseout);cl_add_event(cl_el_days_td, "mousedown", cl_days_mousedown_rep);}cl_el_days_tr.appendChild(cl_el_days_td);}}}function cl_draw_date ( cdate ) {var cyear = cdate.getFullYear();var cmon = cdate.getMonth();var cday = cdate.getDate();if (cmon == 0) {var cyearb = cyear - 1;var cmonb = 11;} else {var cyearb = cyear;var cmonb = cmon - 1;}cl_el_head_td.innerHTML = cl_msg_months[cmon] + ", " + cyear;var firstday_date = new Date( cdate.getFullYear(), cdate.getMonth(), cdate.getDate() );firstday_date.setDate(1);var start_wday = firstday_date.getDay();if ( start_wday == 0 ) start_wday = 7;var last_day = cl_get_lastday( cyear, cmon );var last_day_behind = cl_get_lastday( cyearb, cmonb);var cb =  last_day_behind - ( start_wday - 2 );var show_rows = [1,1,1,1,1,1,1,1];var c = 1;var nextm = 1;for ( var i=2; i<8; i++ ) {for ( var j=0; j<7; j++ ) {if ( i%2 == 0 ) { cl_el_days.rows[i].cells[j].className = "cl-days"; } else { cl_el_days.rows[i].cells[j].className = "cl-dayseven"; }if ( j >= 5 ) { cl_add_class( cl_el_days.rows[i].cells[j], "cl-weekend" ); }cl_el_days.rows[i].cells[j].id = "";cl_remove_event(cl_el_days.rows[i].cells[j], "mousedown", cl_days_behind_mousedown);cl_remove_event(cl_el_days.rows[i].cells[j], "mousedown", cl_days_future_mousedown);if ( i == 2 && j+1 < start_wday ) {if ( i%2 == 0 ) { cl_el_days.rows[i].cells[j].className = "cl-days-behind"; } else { cl_el_days.rows[i].cells[j].className = "cl-dayseven-behind"; }if ( j >= 5 ) { cl_add_class( cl_el_days.rows[i].cells[j], "cl-weekend-behind" ); }cl_el_days.rows[i].cells[j].innerHTML = cb;cl_el_days.rows[i].cells[j].id = cb;cl_add_event(cl_el_days.rows[i].cells[j], "mousedown", cl_days_behind_mousedown);cb++;} else if ( c > last_day ) {if ( i%2 == 0 ) { cl_el_days.rows[i].cells[j].className = "cl-days-behind"; } else { cl_el_days.rows[i].cells[j].className = "cl-dayseven-behind"; }if ( j >= 5 ) { cl_add_class( cl_el_days.rows[i].cells[j], "cl-weekend-behind" ); }cl_el_days.rows[i].cells[j].innerHTML = nextm;cl_el_days.rows[i].cells[j].id = nextm;cl_add_event(cl_el_days.rows[i].cells[j], "mousedown", cl_days_future_mousedown);nextm++;if ( j == 0 ) show_rows[i] = 0;} else {cl_el_days.rows[i].cells[j].innerHTML = c;if ( c == cday ) cl_add_class( cl_el_days.rows[i].cells[j], "cl-selected" );c++;}}}for ( var i=6; i<show_rows.length; i++ ) {if ( show_rows[i] == 1 ) {cl_el_days.rows[i].style.display = ( cl_is_ie ) ? "block" : "table-row";;} else {cl_el_days.rows[i].style.display = "none";}}}function cl_draw_date_rep ( cdate ) {var cyear = cdate.getFullYear();var cmon = cdate.getMonth();var cday = cdate.getDate();if (cmon == 0) {var cyearb = cyear - 1;var cmonb = 11;} else {var cyearb = cyear;var cmonb = cmon - 1;}cl_el_head_td.innerHTML = cl_msg_months[cmon] + ", " + cyear;var firstday_date = new Date( cdate.getFullYear(), cdate.getMonth(), cdate.getDate() );firstday_date.setDate(1);var start_wday = firstday_date.getDay();if ( start_wday == 0 ) start_wday = 7;var last_day = cl_get_lastday( cyear, cmon );var last_day_behind = cl_get_lastday( cyearb, cmonb);var cb =  last_day_behind - ( start_wday - 2 );var show_rows = [1,1,1,1,1,1,1,1];var c = 1;var nextm = 1;for ( var i=2; i<8; i++ ) {for ( var j=0; j<7; j++ ) {if ( i%2 == 0 ) { cl_el_days.rows[i].cells[j].className = "cl-days"; } else { cl_el_days.rows[i].cells[j].className = "cl-dayseven"; }if ( j >= 5 ) { cl_add_class( cl_el_days.rows[i].cells[j], "cl-weekend" ); }cl_el_days.rows[i].cells[j].id = "";cl_remove_event(cl_el_days.rows[i].cells[j], "mousedown", cl_days_behind_mousedown_rep);cl_remove_event(cl_el_days.rows[i].cells[j], "mousedown", cl_days_future_mousedown_rep);if ( i == 2 && j+1 < start_wday ) {if ( i%2 == 0 ) { cl_el_days.rows[i].cells[j].className = "cl-days-behind"; } else { cl_el_days.rows[i].cells[j].className = "cl-dayseven-behind"; }if ( j >= 5 ) { cl_add_class( cl_el_days.rows[i].cells[j], "cl-weekend-behind" ); }cl_el_days.rows[i].cells[j].innerHTML = cb;cl_el_days.rows[i].cells[j].id = cb;cl_add_event(cl_el_days.rows[i].cells[j], "mousedown", cl_days_behind_mousedown_rep);cb++;} else if ( c > last_day ) {if ( i%2 == 0 ) { cl_el_days.rows[i].cells[j].className = "cl-days-behind"; } else { cl_el_days.rows[i].cells[j].className = "cl-dayseven-behind"; }if ( j >= 5 ) { cl_add_class( cl_el_days.rows[i].cells[j], "cl-weekend-behind" ); }cl_el_days.rows[i].cells[j].innerHTML = nextm;cl_el_days.rows[i].cells[j].id = nextm;cl_add_event(cl_el_days.rows[i].cells[j], "mousedown", cl_days_future_mousedown_rep);nextm++;if ( j == 0 ) show_rows[i] = 0;} else {cl_el_days.rows[i].cells[j].innerHTML = c;if ( c == cday ) cl_add_class( cl_el_days.rows[i].cells[j], "cl-selected" );c++;}}}for ( var i=6; i<show_rows.length; i++ ) {if ( show_rows[i] == 1 ) {cl_el_days.rows[i].style.display = ( cl_is_ie ) ? "block" : "table-row";;} else {cl_el_days.rows[i].style.display = "none";}}}function cl_days_behind_mousedown (e) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;var cday = cl_date.getDate();var cmonth = cl_date.getMonth();var cyear = cl_date.getFullYear();cl_date.setMonth( cl_date.getMonth() - 1 );var last_day = cl_get_lastday( cl_date.getFullYear(), cl_date.getMonth() );cl_date.setDate(obj.innerHTML);cl_set_date( cl_date.getFullYear(), (cl_date.getMonth()+1), cl_date.getDate() );cl_hide();}function cl_days_behind_mousedown_rep (e) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;var cday = cl_date.getDate();var cmonth = cl_date.getMonth();var cyear = cl_date.getFullYear();cl_date.setMonth( cl_date.getMonth() - 1 );var last_day = cl_get_lastday( cl_date.getFullYear(), cl_date.getMonth() );cl_date.setDate(obj.innerHTML);cl_set_date( cl_date.getFullYear(), (cl_date.getMonth()+1), cl_date.getDate() );cl_hide_rep();}function cl_days_future_mousedown (e) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;var cday = cl_date.getDate();var cmonth = cl_date.getMonth();var cyear = cl_date.getFullYear();cl_date.setMonth( cl_date.getMonth() + 1 );var last_day = cl_get_lastday( cl_date.getFullYear(), cl_date.getMonth() );cl_date.setDate(obj.innerHTML);cl_set_date( cl_date.getFullYear(), (cl_date.getMonth()+1), cl_date.getDate() );cl_hide();}function cl_days_future_mousedown_rep (e) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;var cday = cl_date.getDate();var cmonth = cl_date.getMonth();var cyear = cl_date.getFullYear();cl_date.setMonth( cl_date.getMonth() + 1 );var last_day = cl_get_lastday( cl_date.getFullYear(), cl_date.getMonth() );cl_date.setDate(obj.innerHTML);cl_set_date( cl_date.getFullYear(), (cl_date.getMonth()+1), cl_date.getDate() );cl_hide_rep();}function cl_get_lastday ( y, m ) {var months = [ 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 ];if ( m == 1 && (y % 4 == 0 && (y % 100 != 0 || y % 400 == 0) ) ) { return 29;} else { return months[m]; }}function cl_parse_date ( str ) {var isfieldok = false;var fy = null; var fm = null; var fd = null;if ( String(str).match(/^(\d\d\d\d)-(\d+)-(\d+)/)  ) {fy = parseInt(RegExp.$1,10);fm = parseInt(RegExp.$2,10);fd = parseInt(RegExp.$3,10);if ( !isNaN(fy) && !isNaN(fm) && !isNaN(fd) ) {fm -= 1;isfieldok = true;}}var rdate = null;if ( isfieldok ) {rdate = new Date( fy, fm, fd );} else {rdate = new Date();}return rdate;}function cl_set_date ( y, m, d ) {if ( m < 10 ) m = "0" + String(m);if ( d < 10 ) d = "0" + String(d);cl_field.value = y + "-" + m + "-" + d;if ( cl_field.fireEvent ) {cl_field.fireEvent("onchange");} else if ( cl_field.dispatchEvent ) {var eve = cl_field.ownerDocument.createEvent("HTMLEvents");eve.initEvent("change",false,true);cl_field.dispatchEvent(eve);}}function cl_days_mouseover ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;if ( String(obj.innerHTML).match(/\d+/) && !String(obj.className).match(/cl-selected/) ) {cl_add_class( obj, "cl-hover" );}}function cl_days_mouseout ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;cl_remove_class( obj, "cl-hover" );}function cl_days_mousedown ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;var inner = obj.innerHTML;if ( !String(inner).match(/\d+/) ) return;if (obj.id != "") return;var cday = parseInt(inner,10);if ( isNaN(cday) ) return;cl_set_date( cl_date.getFullYear(), (cl_date.getMonth()+1), cday );cl_hide();}function cl_days_mousedown_rep ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;var inner = obj.innerHTML;if ( !String(inner).match(/\d+/) ) return;if (obj.id != "") return;var cday = parseInt(inner,10);if ( isNaN(cday) ) return;cl_set_date( cl_date.getFullYear(), (cl_date.getMonth()+1), cday );cl_hide_rep();}function cl_tool_mouseover ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;cl_add_class( obj, "cl-tool-hover" );}function cl_tool_mouseout ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;cl_remove_class( obj, "cl-tool-hover" );}function cl_tool_mouseup ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;var cday = cl_date.getDate();var cmonth = cl_date.getMonth();var cyear = cl_date.getFullYear();cl_date.setDate(1);if ( obj.id == "cl-tool0" ) {cl_date.setFullYear( cl_date.getFullYear() - 1 );var last_day = cl_get_lastday( cl_date.getFullYear(), cl_date.getMonth() );if ( last_day < cday ) cl_date.setDate(last_day); else cl_date.setDate(cday);cl_draw_date(cl_date);} else if ( obj.id == "cl-tool1" ) {cl_date.setMonth( cl_date.getMonth() - 1 );var last_day = cl_get_lastday( cl_date.getFullYear(), cl_date.getMonth() );if ( last_day < cday ) cl_date.setDate(last_day); else cl_date.setDate(cday);cl_draw_date(cl_date);} else if ( obj.id == "cl-tool2" ) {var cl_today_date = new Date();if ( cl_today_date.getFullYear() == cyear && cl_today_date.getMonth() == cmonth && cl_today_date.getDate() == cday ) {cl_set_date( cyear, (cmonth+1), cday );cl_hide();} else {cl_date = cl_today_date;cl_draw_date(cl_date);}} else if ( obj.id == "cl-tool3" ) {cl_date.setMonth( cl_date.getMonth() + 1 );var last_day = cl_get_lastday( cl_date.getFullYear(), cl_date.getMonth() );if ( last_day < cday ) cl_date.setDate(last_day); else cl_date.setDate(cday);cl_draw_date(cl_date);} else if ( obj.id == "cl-tool4" ) {cl_date.setFullYear( cl_date.getFullYear() + 1 );var last_day = cl_get_lastday( cl_date.getFullYear(), cl_date.getMonth() );if ( last_day < cday ) cl_date.setDate(last_day); else cl_date.setDate(cday);cl_draw_date(cl_date);}}function cl_tool_mouseup_rep ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;var cday = cl_date.getDate();var cmonth = cl_date.getMonth();var cyear = cl_date.getFullYear();cl_date.setDate(1);if ( obj.id == "cl-tool0" ) {cl_date.setFullYear( cl_date.getFullYear() - 1 );var last_day = cl_get_lastday( cl_date.getFullYear(), cl_date.getMonth() );if ( last_day < cday ) cl_date.setDate(last_day); else cl_date.setDate(cday);cl_draw_date_rep(cl_date);} else if ( obj.id == "cl-tool1" ) {cl_date.setMonth( cl_date.getMonth() - 1 );var last_day = cl_get_lastday( cl_date.getFullYear(), cl_date.getMonth() );if ( last_day < cday ) cl_date.setDate(last_day); else cl_date.setDate(cday);cl_draw_date_rep(cl_date);} else if ( obj.id == "cl-tool2" ) {var cl_today_date = new Date();if ( cl_today_date.getFullYear() == cyear && cl_today_date.getMonth() == cmonth && cl_today_date.getDate() == cday ) {cl_set_date( cyear, (cmonth+1), cday );cl_hide();} else {cl_date = cl_today_date;cl_draw_date_rep(cl_date);}} else if ( obj.id == "cl-tool3" ) {cl_date.setMonth( cl_date.getMonth() + 1 );var last_day = cl_get_lastday( cl_date.getFullYear(), cl_date.getMonth() );if ( last_day < cday ) cl_date.setDate(last_day); else cl_date.setDate(cday);cl_draw_date_rep(cl_date);} else if ( obj.id == "cl-tool4" ) {cl_date.setFullYear( cl_date.getFullYear() + 1 );var last_day = cl_get_lastday( cl_date.getFullYear(), cl_date.getMonth() );if ( last_day < cday ) cl_date.setDate(last_day); else cl_date.setDate(cday);cl_draw_date_rep(cl_date);}}function cl_tool_mousedown ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;cl_ctool = obj;if ( obj.id == "cl-tool0" || obj.id == "cl-tool4" ) {if (cl_timeout) clearTimeout(cl_timeout);cl_timeout = setTimeout("cl_show_years()", 250);cl_add_event(document, "mouseup", cl_hide_my);if (window.formframe) cl_add_event(formframe.document, "mouseup", cl_hide_my);} else if ( obj.id == "cl-tool1" || obj.id == "cl-tool3" ) {if (cl_timeout) clearTimeout(cl_timeout);cl_timeout = setTimeout("cl_show_months()", 250);cl_add_event(document, "mouseup", cl_hide_my);}cl_stop_event(e);}function cl_tool_mousedown_rep ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;cl_ctool = obj;if ( obj.id == "cl-tool0" || obj.id == "cl-tool4" ) {if (cl_timeout) clearTimeout(cl_timeout);cl_timeout = setTimeout("cl_show_years()", 250);cl_add_event(document, "mouseup", cl_hide_my_rep);cl_add_event(document, "mouseup", cl_hide_my_rep);} else if ( obj.id == "cl-tool1" || obj.id == "cl-tool3" ) {if (cl_timeout) clearTimeout(cl_timeout);cl_timeout = setTimeout("cl_show_months()", 250);cl_add_event(document, "mouseup", cl_hide_my_rep);}cl_stop_event(e);}function cl_show_years () {var cyear = cl_date.getFullYear();for ( var i=0; i<12; i++ ) {cl_el_years.childNodes[i].innerHTML = ( cl_ctool.id == "cl-tool0" ) ? cyear - 1 - i*2 : cyear + 1 + i*2;}var pos = mn_get_obj_pos(cl_ctool);var x = ( cl_ctool.id == "cl-tool0" ) ? pos[0] - 1 : pos[0] + cl_ctool.offsetWidth - cl_el_years.offsetWidth + 1;if ( cl_is_ie ) x += 1;cl_el_years.style.left = x;cl_el_years.style.top = pos[1] + cl_ctool.offsetHeight - 1;cl_el_years.style.visibility = "visible";cl_add_class( cl_ctool, "cl-tool-selected" );}function cl_show_months () {var cmonth = cl_date.getMonth();for ( var i=0; i<12; i++ ) {cl_el_months.childNodes[i].innerHTML = cl_msg_smonths[i];if ( cmonth == i ) { cl_add_class( cl_el_months.childNodes[i], "cl-ym-selected" ); } else { cl_remove_class( cl_el_months.childNodes[i], "cl-ym-selected" ); }}var pos = mn_get_obj_pos(cl_ctool);var x = ( cl_ctool.id == "cl-tool1" ) ? pos[0] : pos[0] + cl_ctool.offsetWidth - cl_el_months.offsetWidth;if ( cl_is_ie ) x += 1;cl_el_months.style.left = x;cl_el_months.style.top = pos[1] + cl_ctool.offsetHeight - 1;cl_el_months.style.visibility = "visible";cl_add_class( cl_ctool, "cl-tool-selected" );}function cl_hide_my () {if (cl_timeout) clearTimeout(cl_timeout);cl_remove_event(document, "mouseup", cl_hide_my);if (window.formframe) cl_remove_event(formframe.document, "mouseup", cl_hide_my);cl_el_years.style.visibility = "hidden";cl_el_months.style.visibility = "hidden";if ( cl_ctool ) cl_remove_class( cl_ctool, "cl-tool-selected" );}function cl_hide_my_rep () {if (cl_timeout) clearTimeout(cl_timeout);cl_remove_event(document, "mouseup", cl_hide_my);cl_remove_event(document, "mouseup", cl_hide_my);cl_el_years.style.visibility = "hidden";cl_el_months.style.visibility = "hidden";if ( cl_ctool ) cl_remove_class( cl_ctool, "cl-tool-selected" );}function cl_combo_mouseover ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;cl_add_class( obj, "cl-ym-hover" );}function cl_combo_mouseout ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;cl_remove_class( obj, "cl-ym-hover" );}function cl_combo_mouseup ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;var cday = cl_date.getDate();cl_date.setDate(1);if ( String(obj.id).match(/ycombo/) ) {cl_date.setFullYear( parseInt(obj.innerHTML,10) );var last_day = cl_get_lastday( cl_date.getFullYear(), cl_date.getMonth() );if ( last_day < cday ) cl_date.setDate(last_day); else cl_date.setDate(cday);cl_draw_date(cl_date);} else if ( String(obj.id).match(/mcombo(\d+)/) ) {cl_date.setMonth( parseInt(RegExp.$1,10) );var last_day = cl_get_lastday( cl_date.getFullYear(), cl_date.getMonth() );if ( last_day < cday ) cl_date.setDate(last_day); else cl_date.setDate(cday);cl_draw_date(cl_date);}}function cl_combo_mouseup_rep ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;var cday = cl_date.getDate();cl_date.setDate(1);if ( String(obj.id).match(/ycombo/) ) {cl_date.setFullYear( parseInt(obj.innerHTML,10) );var last_day = cl_get_lastday( cl_date.getFullYear(), cl_date.getMonth() );if ( last_day < cday ) cl_date.setDate(last_day); else cl_date.setDate(cday);cl_draw_date_rep(cl_date);} else if ( String(obj.id).match(/mcombo(\d+)/) ) {cl_date.setMonth( parseInt(RegExp.$1,10) );var last_day = cl_get_lastday( cl_date.getFullYear(), cl_date.getMonth() );if ( last_day < cday ) cl_date.setDate(last_day); else cl_date.setDate(cday);cl_draw_date_rep(cl_date);}}function cl_check_outclick ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;while ( obj.parentNode ) { if ( obj.id == "calendar" ) return; obj = obj.parentNode; }cl_hide();}function cl_check_outclick_rep ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;while ( obj.parentNode ) { if ( obj.id == "calendar" ) return; obj = obj.parentNode; }cl_hide_rep();}function cl_add_event ( el, evname, func ) {if (el.attachEvent) {el.attachEvent("on" + evname, func);} else if (el.addEventListener) {el.addEventListener(evname, func, true);} else {el["on" + evname] = func;}}function cl_remove_event (el, evname, func) {if (el.detachEvent) {el.detachEvent("on" + evname, func);} else if (el.removeEventListener) {el.removeEventListener(evname, func, true);} else {el["on" + evname] = null;}}function cl_stop_event ( e ) {e || (e = window.event);if ( cl_is_ie ) {e.cancelBubble = true; e.returnValue = false;} else {e.preventDefault(); e.stopPropagation();}return false;}function cl_remove_class ( el, name ) {if (!(el && el.className)) return;var cls = el.className.split(" ");var ar = new Array();for (var i = cls.length; i > 0;) if (cls[--i] != name) ar[ar.length] = cls[i];el.className = ar.join(" ");}function cl_add_class ( el, name ) {cl_remove_class( el, name );el.className += " " + name;}