function Ajax (url, code, postparams) {var method = "GET";if (postparams) {method = "POST";}var xmlhttp = false;try {xmlhttp = new ActiveXObject ("Msxml2.XMLHTTP");} catch (e) {try {xmlhttp = new ActiveXObject ("Microsoft.XMLHTTP");} catch (E) {xmlhttp = false;}}if (!xmlhttp && typeof XMLHttpRequest != "undefined") {try {xmlhttp = new XMLHttpRequest ();} catch (e) {xmlhttp = false;}}if (!xmlhttp && window.createRequest) {try {xmlhttp = window.createRequest ();} catch (e) {xmlhttp = false;}}var send = function () {if (postparams) {xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");xmlhttp.setRequestHeader("Content-length", postparams.length);xmlhttp.setRequestHeader("Connection", "close");xmlhttp.send (postparams);} else {xmlhttp.send (null);}};if (code.length) {xmlhttp.open (method, url, true);xmlhttp.onreadystatechange = function () {if (xmlhttp.readyState==4) {eval (code);}};send ();} else {xmlhttp.open (method, url, false);send ();return (xmlhttp.responseText);}}function ParseXML (xml) {var xmlDoc = 0;try {xmlDoc = new ActiveXObject ("Microsoft.XMLDOM");xmlDoc.async = "false";xmlDoc.loadXML (xml);} catch (e) {try {parser = new DOMParser ();xmlDoc = parser.parseFromString (xml, "text/xml");} catch (e) {}}return xmlDoc;}function AjaxDo (func, params) {Ajax (top.binary, " ", "func=" + func + "&" + params);}function AjaxGet (func, params, code) {return Ajax (top.binary, code, "func=" + func + "&" + params);}function ManagerGet (func, elid, code) {var exec = "var xml = ParseXML (xmlhttp.responseText);var x = xml.documentElement.childNodes;var vals = new Array();for (var i=0; i<x.length; i++) {var v = (x[i].childNodes[0]) ? x[i].childNodes[0].nodeValue : '';vals[x[i].nodeName] = v;}; " + code;AjaxGet (func, "out=xml&elid=" + elid, exec);}function filename_event(){fr_hs_fields([], ['filename1']);}function filename1_event(){fr_hs_fields([], ['filename2']);}function CheckLoadedFile(){fr_hs_fields(['h_filename','h_filename1','filename1','h_filename2','filename2'], []);var form = document.frm;if(form.h_filename) {if(form.h_filename.value != ""){fr_hs_fields(['filename'], ['h_filename','filename1']);}}if(form.h_filename1) {if(form.h_filename1.value != ""){fr_hs_fields(['filename1'], ['h_filename1','filename2']);}}if(form.h_filename2) {if(form.h_filename2.value != ""){fr_hs_fields(['filename2'], ['h_filename2']);}}}function uploadComplete(doc) {var form = document.frm;returnFormAttr();if (!doc) {fr_enabled();return;}var err = doc.getElementsByTagName("error");if(err[0]) {alert('error: ' + err[0].childNodes[0].nodeValue);fr_enabled();return;}var filename = doc.getElementsByTagName("filename");if(filename[0]) if(form.h_filename)	form.h_filename.value = filename[0].childNodes[0].nodeValue;var filename1 = doc.getElementsByTagName("filename1");if(filename1[0]) if(form.h_filename1) form.h_filename1.value = filename1[0].childNodes[0].nodeValue;var filename2 = doc.getElementsByTagName("filename2");if(filename2[0]) if(form.h_filename2) form.h_filename2.value = filename2[0].childNodes[0].nodeValue;frm.submit();}function removeElement(id){var Node = document.getElementById(id);if(Node) {Node.parentNode.removeChild(Node);}}function createIFrame() {var id = 'f' + Math.floor(Math.random() * 99999);var div = document.createElement('div');div.innerHTML = '<iframe style="display:none" src="about:blank" id="'+id+'" name="'+id+'" onload="sendComplete(\''+id+'\')"></iframe>';document.body.appendChild(div);return document.getElementById(id);}function sendForm(url, func) {if (!document.createElement) return;var form =document.frm;form.setAttribute("enctype", "multipart/form-data");form.setAttribute("encoding", "multipart/form-data");var frame=createIFrame();frame.onSendComplete = function() { func(getIFrameXML(frame)); };form.setAttribute('target', frame.id);form.setAttribute('action', url);form.submit();}function returnFormAttr() {var form =document.frm;form.setAttribute('action', top.binary);form.setAttribute("enctype", '');form.removeAttribute("encoding");form.setAttribute('target', 'formframe');}function sendComplete(id) {var iframe=document.getElementById(id);if (iframe.onSendComplete && typeof(iframe.onSendComplete) == 'function') iframe.onSendComplete();}function getIFrameXML(iframe) {var doc=iframe.contentDocument;if (!doc && iframe.contentWindow)	doc=iframe.contentWindow.document;if (!doc) doc=window.frames[iframe.id].document;if (!doc) return null;if (doc.location=="about:blank") return null;if (doc.XMLDocument) doc=doc.XMLDocument;return doc;}