var isIE = ( navigator.userAgent.indexOf("MSIE") != -1 ) ? true : false;var isIE = ( navigator.userAgent.indexOf("MSIE") != -1 ) ? true : false;var isIE2 = ( /msie/i.test(navigator.userAgent) && !/opera/i.test(navigator.userAgent) );var isOpera = ( /opera/i.test(navigator.userAgent) );window.scrollWidth = 17;var tb_sep_divs = new Array();var tb_sep_drag = null;var tb_mtable = null;var tb_htable = null;var tb_ftable = null;var tb_mtd = null;var tb_htd = null;var tb_ftd = null;var tb_last_sel = 0;var tb_sort_col = -1;var tb_sort_order = false;var tb_chart = [];var tb_chart_docxml = null;function tb_chart_load ( chart ) {if ( !chart ) return;var chart_template = { line:"isp-line", histogram:"isp-bar", pie:"isp-pie" };var ctemplate = chart_template[chart["type"]];var msgother = "Other"; try { if (msg_other) msgother = msg_other; } catch(ex){}var ht = tb_get_obj(chart["hid"]);var mt = tb_get_obj(chart["mid"]);if ( chart["type"] == "line" && mt.rows.length == 1 ) { tb_chart_hide( chart ); return; }if ( chart["type"] == "line" && mt.rows.length < 32 ) { ctemplate = "isp-shortline"; }if ( !tb_chart_docxml ) { tb_chart_docxml = Ajax( top.imgpath + "anychart.xml?" + Math.floor(Math.random()*500), "" ); }var xmldoc = ParseXML(tb_chart_docxml);;var labels = [];var datanames = {};var datacols = {};for ( var i=0; i<ht.rows[0].cells.length; i++ ) {if ( ht.rows[0].cells[i].getAttribute("colname") == chart["label"] ) { for ( var j=0; j<mt.rows.length; j++ ) { labels.push( String(mt.rows[j].cells[i].innerHTML).replace(/<.*?>/g,"").replace(/^\s*|\s*$/g,"").replace(/&gt;/g,">").replace(/&lt;/g,"<").substr(0,30) ); } }for ( var j=0; j<chart["data"].length; j++ ) {if ( ht.rows[0].cells[i].getAttribute("colname") == chart["data"][j] ) {datacols[chart["data"][j]]  = i;datanames[chart["data"][j]]  = String(ht.rows[0].cells[i].innerHTML).replace(/<.*?>/g,"").replace(/^\s*|\s*$/g,"");}}}var eroot = xmldoc.documentElement;var echart = eroot.getElementsByTagName("chart")[0];echart.setAttribute("template",ctemplate);var seriescount = 0;var othersum = 0;var edata = eroot.getElementsByTagName("data")[0];for ( var i=0; i<chart["data"].length; i++ ) {var colname = chart["data"][i];if ( !datanames[colname] ) continue;var seriessum = 0;var eseries = xmldoc.createElement("series");eseries.setAttribute("name",datanames[colname]);var pointsnum = 0;for ( var j=0; j<mt.rows.length; j++ ) {if ( chart["type"] == "histogram" && j > 29 ) break;var py = parseFloat(String(mt.rows[j].cells[datacols[colname]].innerHTML).replace(/<.*?>/g,""));if ( isNaN(py) ) py = 0;seriessum += py;if ( chart["type"] == "pie" ) {if ( pointsnum < 5 ) {if ( py == 0 ) { continue; }var epoint = xmldoc.createElement("point");epoint.setAttribute("name",labels[j]); epoint.setAttribute("y",py); eseries.appendChild(epoint);} else {othersum += py;if ( j == mt.rows.length-1 ) {var epoint = xmldoc.createElement("point");epoint.setAttribute("name",msgother); epoint.setAttribute("y",othersum); eseries.appendChild(epoint);}}pointsnum++;} else {var epoint = xmldoc.createElement("point");epoint.setAttribute("name",labels[j]); epoint.setAttribute("y",py); eseries.appendChild(epoint);}}if ( seriessum > 0 ) {edata.appendChild(eseries);seriescount++;}}if ( seriescount == 0 ) { tb_chart_hide( chart ); return; }var xmlstr = ( xmldoc.xml ) ? xmldoc.xml : (new XMLSerializer()).serializeToString(xmldoc);chart["obj"].setData(xmlstr);}function tb_chart_hide ( chart ) {if ( !chart ) return;var parentdiv = tb_get_obj(chart["parentid"]);if ( !parentdiv ) return;parentdiv.parentNode.removeChild(parentdiv);}function tb_count_stat () {var rcount = 0;var rstat = {};var rtype = {};var status = 0;var fixnum = 0;var rtypestatus = 0;for ( var i=0; i<va.length; i++ ) if ( va[i][1] == 1 ) { status = 1; break; };if ( status == 0 ) {rstat = tbltotal;rcount = tblcount;rtypestatus = 1;} else {for ( var i=0; i<va.length; i++ ) {var entry = va[i];if ( entry[1] == status ) {var desc = entry[0];for ( var j=0; j<tblparam.length; j++ ) {var currParam = tblparam[j];var currTblstatParam = tblstat[desc][currParam];rtype[j] = 0;if ( currTblstatParam != null ) {if ( currTblstatParam.splice ) {if ( rstat[currParam] == null ) rstat[currParam] = [0,0];rstat[currParam][0] += currTblstatParam[0];rstat[currParam][1] += currTblstatParam[1];} else if ( String(currTblstatParam).match(/^(\-?\d+(\.\d+)?)\s+(\w+)$/) ) {rtype[j] = 2;fixnum = ( String(RegExp.$2).length - 1 > fixnum ) ? String(RegExp.$2).length - 1 : fixnum;if ( rstat[currParam] == null ) rstat[currParam] = {};if ( !rstat[currParam][RegExp.$3] ) {rstat[currParam][RegExp.$3] = parseFloat(RegExp.$1);} else {rstat[currParam][RegExp.$3] += parseFloat(RegExp.$1);}} else if ( String(currTblstatParam).match(/^(\-?\d+(\.\d+)?)$/) ) {rtype[j] = 0;fixnum = ( String(RegExp.$2).length - 1 > fixnum ) ? String(RegExp.$2).length - 1 : fixnum;if ( rstat[currParam] == null ) rstat[currParam] = 0;rstat[currParam] += parseFloat(currTblstatParam);}}}rcount++;}}}var sep = ",&nbsp;&nbsp;";var counttxt = ( status == 0 ) ? top.msg_total+" - "+rcount : top.msg_selected+" - "+rcount;tb_get_obj("0-foot").innerHTML = counttxt;var footstat = new Array();for ( var i=0; i<tblparam.length; i++ ) {var cstr = ""; var cnum = 0; var cname = "";if ( rstat[tblparam[i]] == null ) continue;if ( tblparam[i].match(/^(\-?\d+)-(.*)$/) ) {cnum = RegExp.$1; cname = RegExp.$2;} else { continue; }if ( cname == "col" ) {if ( rtype[i] == 1 || (rstat[tblparam[i]].splice) ) {cstr += rstat[tblparam[i]][0]+" / "+rstat[tblparam[i]][1];} else if ( rtype[i] == 2 ) {for ( j in rstat[tblparam[i]] ) {if ( rstat[tblparam[i]][j].toFixed ) { rstat[tblparam[i]][j] = rstat[tblparam[i]][j].toFixed(fixnum); rstat[tblparam[i]][j] = String(rstat[tblparam[i]][j]).replace(/\.0+$/,""); }cstr += rstat[tblparam[i]][j] + " " + j + "; ";}if ( cstr.length > 2 ) cstr = cstr.substr(0,cstr.length-2);} else if ( rtype[i] == 0 || rtypestatus == 1 ) {if ( rstat[tblparam[i]].toFixed ) { rstat[tblparam[i]] = rstat[tblparam[i]].toFixed(fixnum); rstat[tblparam[i]] = String(rstat[tblparam[i]]).replace(/\.0+$/,""); }if(typeof rstat[tblparam[i]] == 'object') {for(var keyVar in rstat[tblparam[i]]) {cstr += KeyVar + ' ' + rstat[tblparam[i]][KeyVar];}} else {cstr += rstat[tblparam[i]];}}} else {if ( animeprop[cname] ) {cstr += "<img src='" + top.imgpath + cname +".gif' class='pimg' align='absmiddle' width='16' height='16'>- " + rstat[tblparam[i]];} else {if (rstat[tblparam[i]] != 0)cstr += ( fixpng == "" ) ? "<img src='" + top.imgpath + cname +".png' class='pimg' align='absmiddle' width='16' height='16'>- " + rstat[tblparam[i]]: "<img src='" + top.imgpath + "e.gif' class='pimg' align='absmiddle' width='16' height='16' style=\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='" + top.imgpath + cname + ".png',sizingMethod='scale')\">- " + rstat[tblparam[i]];}}if ( footstat[cnum] ) {footstat[cnum] += ( rstat[tblparam[i]] != 0 ) ? sep + cstr : cstr;}else { footstat[cnum] = cstr; }}for ( var i=0; i<cols.length; i++ ) {var cfootstat = tb_get_obj(i+"-foot");if ( !cfootstat ) continue;if ( footstat[i] ) {cfootstat.innerHTML = footstat[i];} else if ( i != 0) {cfootstat.innerHTML = "&nbsp;";}}}function tb_prop_link ( url ) {var inputnode = document.createElement("a");inputnode.setAttribute("target","_blank");inputnode.setAttribute("href",url);top.workarea.appendChild( inputnode );inputnode.onclick;}function tb_dismiss ( id ) {var banpane = document.getElementById("bannerpane");if ( banpane ) banpane.style.display = "none";top.mn_resize_window();top.fka.location = top.binary+"?func=dismiss&elid=" + id;}function tb_escape ( str ) {try { str = encodeURIComponent(str);} catch(e) { str = escape(str); }str = str.replace(/\+/g,"%2B");return str;}function tb_get_array_pos ( id ) {for ( var i=0; i<va.length; i++ ) if (va[i][2] == id) return i;}function tb_file_is_folder () {for ( var i=0; i<va.length; i++ ) {if ( va[i][1] == 1 ) {var ihtml = document.getElementById(va[i][2]).cells[0].innerHTML;if ( (ihtml.match(/src="[^"]*p-file-(\d+)/) || ihtml.match(/\/p-file-(\d+)/)) ) {var num = parseInt(RegExp.$1);var rval = ( num == 99 ) ? 2 : ( num < 100 ) ? 1 : 0;return rval;}return 0;}}return -1;}function tb_get_graph () {var diagram = new Array();var mt = tb_get_obj("MAINTBL").tBodies[0];var ht = tb_get_obj("MAINTBL").tBodies[1];var colspos = new Array();for ( var i=0; i<diagramdata.length; i++ ) {for ( var j=0; j<cols.length; j++ ) {if ( diagramdata[i] == cols[j] ) {colspos.push(j);}}}if ( diagramtype == "pie" ) {for ( var i=0; i<mt.rows.length; i++ ) {var coldata = new Array();for ( var j=0; j<colspos.length; j++ ) {var val = String(mt.rows[i].cells[colspos[j]].innerHTML).replace(/<.*?>/g,"");if ( val == "&nbsp;" ) val = 0;coldata.push( val );}diagram.push(coldata);}} else {for ( var i=0; i<colspos.length; i++ ) {var coldata = new Array();coldata.push(diagramlabels[i]);for ( var j=0; j<mt.rows.length; j++ ) {var val = String(mt.rows[j].cells[colspos[i]].innerHTML).replace(/<.*?>/g,"");if ( val == "&nbsp;" ) val = 0;coldata.push( val );}diagram.push(coldata);}}return diagram;}function tb_get_sel_item() {for ( var i=0; i<va.length; i++ )if ( va[i][1] == 1 )return va[i][0];return "";}function tb_get_sel_items() {var relems = new Array();for ( var i=0; i<va.length; i++ )if ( va[i][1] == 1 )relems[relems.length] = va[i][0];return relems;}function tb_get_obj ( id ) {if ( document.getElementById ) return document.getElementById(id);else if ( document.all ) return document.all[id];else return null;}function tb_get_obj_pos ( obj ) {x = 0; y = 0;while ( obj.offsetParent ) { x += obj.offsetLeft; y += obj.offsetTop; obj = obj.offsetParent; }return [x,y];}function tb_init () {top.mn_set_active( String(location.search) );top.mn_dbborder(1);var ww = ( window.innerWidth ) ? window.innerWidth : document.body.clientWidth;var headDiv = tb_get_obj("headDiv");var footDiv = tb_get_obj("footDiv");var scrollDiv = tb_get_obj("scrollDiv");tb_mtable = tb_get_obj("MAINTBL");headDiv.innerHTML = "<table id='hMAINTBL' class='content-table' border='0' cellpadding='0' cellspacing='0'><tbody class='mainHead' id='mainHead'>" + tb_mtable.tBodies[1].innerHTML + "</tbody></table>";footDiv.innerHTML = "<table id='fMAINTBL' class='content-table' border='0' cellpadding='0' cellspacing='0'><tbody class='mainFoot'>" + tb_mtable.tBodies[2].innerHTML + "</tbody></table>";tb_htable = tb_get_obj("hMAINTBL");tb_ftable = tb_get_obj("fMAINTBL");tb_mtd = tb_mtable.rows[0].cells;tb_htd = tb_htable.rows[0].cells;tb_ftd = tb_ftable.rows[0].cells;tb_ftd1 = tb_ftable.rows[1].cells;var twidth = 0; var tprocwidth = 0; var tdwidths = new Array();for ( var i=0; i<tb_mtd.length; i++ ) { tdwidths[i] = tb_mtd[i].offsetWidth; twidth += tdwidths[i]; }if ( tb_mtd.length > 2 ) {for ( var i=0; i<tb_mtd.length; i++ ) {if ( tdwidths[i] > twidth/2 ) {var otherw = 0; for ( var j=0; j<tb_mtd.length; j++ ) if ( i != j ) otherw += tdwidths[j];tdwidths[i] = otherw; twidth = otherw*2;break;}}}if (scrollDiv.offsetWidth - scrollDiv.clientWidth == 0) {scrollDiv.className += ' macScroll';}tb_mtable.style.tableLayout = "fixed"; tb_htable.style.tableLayout = "fixed"; tb_ftable.style.tableLayout = "fixed";for ( var i=0; i<tb_mtd.length; i++ ) {var cw = 0;if ( i == tb_mtd.length-1 ) { cw = 100 - tprocwidth; } else { cw = parseInt(100*tdwidths[i]/twidth); tprocwidth += cw; }tb_mtd[i].style.width = cw+"%"; tb_htd[i].style.width = cw+"%"; tb_ftd[i].style.width = cw+"%";}tb_mtable.removeChild(tb_mtable.tBodies[2]);tb_mtable.removeChild(tb_mtable.tBodies[1]);var n = 0;for ( var i=0; i<tb_ftd1.length; i++ ) {for ( var j=0; j<tb_ftd1[i].colSpan; j++ ) {if ( j < tb_ftd1[i].colSpan - 1 ) tb_ftd[n].style.borderRightColor = "#AFCAEC";n++;}}if ( ww - tb_mtable.offsetWidth > 0 ) window.scrollWidth = ww - tb_mtable.offsetWidth;if ( tb_mtable.offsetWidth == 0 ) window.scrollWidth = 17;tb_get_obj("headSq").style.width = window.scrollWidth;tb_get_obj("footSq").style.width = window.scrollWidth;var bTable = tb_get_obj("bTable");for ( var i=0; i<tb_htd.length-1; i++ ) {tb_sep_divs[i] = document.createElement("div");tb_sep_divs[i].id = i + "sep";if ( navigator.userAgent.match(/msie/i) ) tb_sep_divs[i].innerHTML = "&nbsp;";tb_sep_divs[i].style.height = tb_htd[i].offsetHeight;tb_sep_divs[i].className = "sepdiv";tb_sep_divs[i].onmousedown	= tb_sep_md; if (tb_sep_divs[i].captureEvents) tb_sep_divs[i].captureEvents(Event.MOUSEDOWN);document.body.appendChild( tb_sep_divs[i] );}var interval = setTimeout("tb_resize()",1);var interval2 = setTimeout("showerror()",2);tb_toolbar();for ( var i=0; i<tb_chart.length; i++ ) { tb_chart_load( tb_chart[i] );	}if(typeof touchScroll == 'function'){touchScroll('scrollDiv');}}function tb_op_group( op ) {var selvals = "";var almsg = "";var n = 0;for ( var i=0; i<va.length; i++ ) {if ( va[i][1] == 1 ) {var elval = "";if ( selvals != "" ) elval += ", ";elval += va[i][0];if ( slave != "" ) { elval += " @ " + slave; } else if ( va[i].length == 4 ) { elval += " @ " + va[i][3]; }selvals += elval;if ( n < 10 ) {if ( vn.length > 0 ) {if ( almsg != "" ) almsg += ", ";var mval = "";for ( var y=0; y<va.length; y++ )  { if ( va[i][0] == vn[y][0] ) mval = vn[y][1];  }almsg += ( mval != "" ) ? mval : va[i][0];} else {almsg += elval;}}n++;}}if ( selvals == "" ) { alert(top.msg_nosel); return; }if ( n > 10 ) { almsg += msg_totalelem.replace(/%s/,n); }if ( confirm( eval("msg_"+op.replace(/\./g, "_"))+" "+almsg+' ?') ) {top.mn_currlist = ( iserror && top.mn_successlist != "" ) ? top.mn_successlist : String(location);var params = {};params["func"] = op;params["elid"] = selvals;if ( pkey != '' ) params["plid"] = pkey;tb_post_location ( top.binary, params, "workarea" );}}function tb_op_groupform( op, nosel ) {var selvals = "";for ( var i=0; i<va.length; i++ ) {if ( va[i][1] == 1 ) {if ( selvals != "" ) selvals += ", ";selvals += va[i][0];if ( slave != "" ) { selvals += " @ " + slave; } else if ( va[i].length == 4 ) { selvals += " @ " + va[i][3]; }}}if ( !nosel && selvals == "" ) { alert(top.msg_nosel); return; }top.mn_form_show( top.binary+"?func=keepalive" );var params = {};params["func"] = op;params["elid"] = selvals;if ( pkey != '' ) params["plid"] = pkey;if ( nosel ) params["parentfunc"] = clistfunc;tb_post_location ( top.binary, params, "formframe" );}function tb_op_edit( op, islist ) {var key = "";var eslave = "";for ( var i=0; i<va.length; i++ ) {if (va[i][1] == 1) {key = va[i][0];if ( slave != "" ) { eslave = slave; } else if ( va[i].length == 4 ) { eslave = va[i][3]; }break;}}if ( key != "" ) {var loc = top.binary+"?func="+op+'&elid='+tb_escape(key);if ( eslave != "" ) loc = loc + '&slave='+tb_escape(eslave);if ( pkey != "" ) loc = loc + '&plid='+tb_escape(pkey);if ( tfilter != "" ) loc = loc + "&tfilter=" + tb_escape(tfilter);if ( islist ) { top.workarea.location = loc; }else { top.mn_form_show(loc); }} else {alert(top.msg_nosel);}}function tb_op_new( op, islist ) {var loc = top.binary+"?func="+op+'&plid='+tb_escape(pkey);if ( slave != "" ) loc = loc + "&slave=" + tb_escape(slave);if ( tfilter != "" ) loc = loc + "&tfilter=" + tb_escape(tfilter);if ( islist ) {	top.workarea.location = loc; }else { top.mn_form_show(loc); }}function tb_op_back(op) {var pos = pkey.lastIndexOf('/');if (pos == -1) {var loc = top.binary+"?func="+op;if ( tfilter != "" ) loc = loc + "&tfilter=" + tb_escape(tfilter);location = loc;return;}pkey = pkey.substring(0, pos);pos = pkey.lastIndexOf('/');if (pos == -1) {var loc = top.binary+"?func="+op+'&elid='+tb_escape(pkey);if ( tfilter != "" ) loc = loc + "&tfilter=" + tb_escape(tfilter);location = loc;return;}location = top.binary+"?func="+op+'&plid='+tb_escape(pkey.substring(0, pos))+'&elid='+tb_escape(pkey.substr(pos+1));}function tb_pager_submit(cnt, default_value){pnum=1;pcnt=(function(){cnt = cnt.replace(/[^0-9]/g, '');if(!cnt) return default_value;if(cnt > 3000) return 3000;return cnt;})();tb_pager();return false;}function tb_pager () {var pager = "&p_num="+pnum+"&p_cnt="+tb_escape(pcnt)+"&p_sort="+psort+"&p_order="+porder;location = String(location).replace(/&?p_\w+=[^&]*/g,'') + pager;}function tb_post_location ( url, params, target ) {var formnode = document.createElement("form");formnode.setAttribute("method","POST");formnode.setAttribute("action",url);formnode.setAttribute("target",target);formnode.setAttribute("id","postform");for ( var i in params ) {var inputnode = document.createElement("input");inputnode.setAttribute("type","hidden");inputnode.setAttribute("name",i);inputnode.setAttribute("value",params[i]);formnode.appendChild( inputnode );}document.body.appendChild(formnode);formnode.submit();}function tb_get_graph_rep (mid) {var diagram = new Array();var mt = tb_get_obj(mid).tBodies[1];var ht = tb_get_obj(mid).tBodies[0];var colspos = new Array();for ( var i=0; i<diagramdata.length; i++ ) {for ( var j=0; j<cols.length; j++ ) {if ( diagramdata[i] == cols[j] ) {colspos.push(j);}}}if ( diagramtype == "pie" ) {for ( var i=0; i<mt.rows.length; i++ ) {var coldata = new Array();for ( var j=0; j<colspos.length; j++ ) {var val = String(mt.rows[i].cells[colspos[j]].innerHTML).replace(/<.*?>/g,"");if ( val == "&nbsp;" ) val = 0;if ( val == "" ) val = 0;if ( val == " " ) val = 0;coldata.push( val );}diagram.push(coldata);}} else {for ( var i=0; i<colspos.length; i++ ) {var coldata = new Array();coldata.push(diagramlabels[i]);for ( var j=0; j<mt.rows.length; j++ ) {var val = String(mt.rows[j].cells[colspos[i]].innerHTML).replace(/<.*?>/g,"");if ( val == "&nbsp;" ) val = 0;if ( val == "" ) val = 0;coldata.push( val );}diagram.push(coldata);}}return diagram;}function tb_resize () {tb_addtoolbar_hide();var ww = ( window.innerWidth ) ? window.innerWidth : document.body.clientWidth;var wh = ( window.innerHeight ) ? window.innerHeight : document.body.clientHeight;var pos = tb_get_obj_pos(tb_get_obj("bTbody2"));var fh = tb_get_obj("bTbody3").offsetHeight;if ( wh - pos[1] - fh > 0 ) { tb_get_obj("scrollDiv").style.height = wh - pos[1] - fh; }tb_sep_pos();tb_toolbar_resize();}function tb_toolbar_resize () {var tooltds = tb_get_obj('toolbar-table').tBodies[0].rows[0].cells;for ( var i=0; i<tooltds.length; i++ ) {if ( tooltds[i].style.display == "none" ) {tooltds[i].style.display = ( isIE ) ? "block" : "table-cell";}}tb_get_obj("toolexp").className = "toolexp";var ww = ( window.innerWidth ) ? window.innerWidth : document.body.clientWidth;ww -= tb_get_obj("toolline1").offsetWidth;var title = tb_get_obj("title");var title_td = tb_get_obj("toolline2");var toolbar = tb_get_obj("toolbar-table");var toolbar_td = tb_get_obj("toolline3");if ( title.offsetWidth + toolbar.offsetWidth < ww ) {title_td.style.width = title.offsetWidth;toolbar_td.style.width = ( isOpera ) ? "auto" : ww - title.offsetWidth;} else {if ( title.offsetWidth < toolbar.offsetWidth ) {title_td.style.width = title.offsetWidth;toolbar_td.style.width = ( isOpera ) ? "auto" : ww - title.offsetWidth;if ( title.offsetWidth > ww/2 ) {var tw = Math.floor(ww/2);title_td.style.width = tw;toolbar_td.style.width = ww - tw;}var isHide = false; var n = 0;while ( toolbar.offsetWidth > toolbar_td.offsetWidth ) {for ( var i=tooltds.length-3; i>0; i-- ) {if ( tooltds[i].getAttribute("firstbtn") == "yes" ) { n = 100; break; }if ( tooltds[i].style.display != "none" ) {tooltds[i].style.display = "none";if ( tooltds[i-1].className == "toolsep" ) tooltds[i-1].style.display = "none";isHide = true;break;}}n++; if ( n > 50 ) break;}if ( isHide ) tb_get_obj("toolexp").className = "toolexp-act";} else {title_td.style.width = ( isOpera ) ? "auto" : ww - toolbar.offsetWidth;toolbar_td.style.width = toolbar.offsetWidth;}}}function tb_addtoolbar ( expbtn ) {var tlayer = tb_get_obj("addtoolbar");if ( tlayer.style.display == "block" ) { tb_addtoolbar_hide(); return; }tlayertd = tb_get_obj("addtoolbar-pane");tlayertd.innerHTML = "";var ntoolbar = tb_get_obj("toolbar-table").cloneNode(true);ntoolbar.id = "add-toolbar-table";var cells = ntoolbar.tBodies[0].rows[0].cells;var nflag = false;for ( var i=0; i<cells.length; i++ ) {if ( cells[i].style.display == "none" ) {if ( !nflag && cells[i].className == "toolsep" ) continue;cells[i].style.display = ( isIE ) ? "block" : "table-cell";nflag = true;} else {cells[i].style.display = "none";}if ( cells[i].id == "toolexp" ) { cells[i].id = "ntoolexp"; }}var canvases = ntoolbar.getElementsByTagName("canvas");for ( var i=0; i<canvases.length; i++ ) {var ncanvas = canvases[i];var ncontext = ncanvas.getContext("2d");var oid = ncanvas.id; ncanvas.id = "n" + oid;var ocanvas = tb_get_obj(oid);var ocontext = ocanvas.getContext("2d");ncontext.putImageData(ocontext.getImageData(0,0,ocanvas.width,ocanvas.height),0,0,0,0,ncanvas.width,ncanvas.height);}tlayertd.appendChild(ntoolbar);tlayer.style.top = tb_get_obj_pos(expbtn)[1]+expbtn.offsetHeight-2;tlayer.style.display = "block";tb_add_event(top.document, "mousedown", tb_addtoolbar_outclick);tb_add_event(document, "mousedown", tb_addtoolbar_outclick);}function tb_addtoolbar_hide () {tb_remove_event(top.document, "mousedown", tb_addtoolbar_outclick);tb_remove_event(document, "mousedown", tb_addtoolbar_outclick);tb_get_obj("addtoolbar").style.display = "none";}function tb_addtoolbar_outclick ( e ) {e || (e = window.event);var obj = ( e.target ) ? e.target : e.srcElement;while ( obj.parentNode ) { if ( obj.id == "addtoolbar" || obj.id == "toolexp" ) return; obj = obj.parentNode; }tb_addtoolbar_hide();}function tb_row ( event ) {event || (event = window.event);var obj = ( event.target ) ? event.target : event.srcElement;while ( obj.tagName && obj.tagName.toLowerCase() != "tr" && obj.parentNode ) obj = obj.parentNode;if ( !obj.id ) return;var e = tb_get_array_pos(obj.id);if ( event.shiftKey ) {tb_row_unselect_all();min = tb_last_sel > e ? e : tb_last_sel ;max = tb_last_sel > e ? tb_last_sel : e ;for ( var i=min; i<=max; i++ ) tb_row_select(i,1);if ( document.selection ) { if ( document.selection.type.toLowerCase() != "none" ) document.selection.empty(); }else if ( window.getSelection ) {window.getSelection().collapseToStart(); }} else if ( event.ctrlKey || event.metaKey  ) {if ( va[e][1] == 0 ) tb_last_sel = e;if ( va[e][1] == 1 && tb_last_sel == e ) tb_last_sel = 0;va[e][1] == 0 ? tb_row_select(e,1) : tb_row_select(e,0);if ( document.selection ) { if ( document.selection.type.toLowerCase() != "none" ) document.selection.empty(); }else if ( window.getSelection ) { window.getSelection().collapseToStart(); }} else {tb_row_unselect_all();tb_row_select(e,1);tb_last_sel = e;}tb_toolbar();tb_count_stat();}function tb_toolbar() {var scount = 0; for ( var i=0; i<va.length; i++ ) if ( va[i][1] == 1 ) { scount++; }var tooltds = document.getElementById('toolbar-table').tBodies[0].rows[0].cells;for ( var i=0; i<tooltds.length; i++ ) {var btype = tooltds[i].getAttribute("btype");var bactive = tooltds[i].getAttribute("bactive");if ( btype == null ) continue;if ( ( scount == 0 && ( btype == 1 || btype == 2 )) || ( scount > 1 && btype == 1 ) ) {if ( bactive == 1 ) {grayscale(tooltds[i].getElementsByTagName('img')[0]);tooltds[i].setAttribute("bactive",0);tooltds[i].style.cursor = "default";}} else {if ( bactive == 0 ) {grayscale.reset(tooltds[i].getElementsByTagName('img')[0]);tooltds[i].setAttribute("bactive",1);tooltds[i].style.cursor = "pointer";}}}}function tb_row_edit ( e ) {e || (e = window.event);var flag = false;for ( var i=0; i<va.length; i++ ) if ( va[i][1] == 1 ) flag = true;if ( !flag ) return;if ( dblact != "" ) {eval( dblact.replace(/javascript:/,"") );} else if ( window.Edit != null ) {Edit();}}function tb_row_select ( n, type ) {va[n][1] = type;var row = document.getElementById(va[n][2]);if ( row == null ) return;for ( var i=0; i<row.cells.length; i++ )if ( type ) { tb_add_class(row.cells[i],'sel'); } else { tb_remove_class(row.cells[i],'sel'); }}function tb_row_unselect_all () {for ( var i=0; i<va.length; i++) if (va[i][1]==1) tb_row_select(i,0);}function tb_sep_md ( e ) {if (!e) var e = window.event;tb_sep_drag = {};tb_sep_drag.divobj = ( e.target ) ? e.target : e.srcElement;tb_sep_drag.ctrl = ( e.ctrlKey || e.metaKey );var onum = parseInt(tb_sep_drag.divobj.id);tb_sep_drag.minx = tb_get_obj_pos(tb_htd[onum])[0] + 20;tb_sep_drag.maxx = tb_get_obj_pos(tb_htd[onum+1])[0] +tb_htd[onum+1].offsetWidth - 20;tb_sep_drag.divobj.className = "sepdiv2";tb_sep_drag.divobj.style.height = tb_get_obj("scrollDiv").offsetHeight + tb_htable.offsetHeight;document.onmouseup	 = tb_sep_mu; if (document.captureEvents) document.captureEvents(Event.MOUSEUP);document.onmousemove = tb_sep_mm; if (document.captureEvents) document.captureEvents(Event.MOUSEMOVE);tb_stop_event ( e );}function tb_sep_mu () {if ( tb_sep_drag ) {tb_sep_drag.divobj.className = "sepdiv";tb_sep_drag.divobj.style.height = tb_htable.offsetHeight;var onum = parseInt(tb_sep_drag.divobj.id);var colw = parseInt(tb_sep_drag.divobj.style.left) - tb_get_obj_pos(tb_htd[onum])[0];var colwproc = parseInt(100*colw/tb_htable.offsetWidth);var colwprocnext = parseInt(tb_htd[onum].style.width) + parseInt(tb_htd[onum+1].style.width) - colwproc;var tdwidths = new Array();var sumtdwidths = 0;for ( var i=0; i<tb_htd.length; i++ ) {if ( tb_sep_drag.ctrl ) {tdwidths[i] = ( i == onum ) ? colwproc : parseInt(tb_htd[i].offsetWidth*(100-colwproc)/(tb_htable.offsetWidth - tb_htd[onum].offsetWidth));} else {tdwidths[i] = ( i == onum ) ? colwproc : ( i == onum+1 ) ? colwprocnext : parseInt(tb_htd[i].style.width);}sumtdwidths += tdwidths[i];}tdwidths[0] += 100 - sumtdwidths;tb_mtable.style.tableLayout = "auto"; tb_htable.style.tableLayout = "auto"; tb_ftable.style.tableLayout = "auto";tb_mtable.style.width = "auto"; tb_htable.style.width = "auto"; tb_ftable.style.width = "auto";for ( var i=0; i<tb_htd.length; i++ ) { tb_mtd[i].style.width = "auto"; tb_htd[i].style.width = "auto"; tb_ftd[i].style.width = "auto"; }for ( var i=0; i<tb_htd.length; i++ ) { tb_mtd[i].style.width = tdwidths[i]+"%"; tb_htd[i].style.width = tdwidths[i]+"%"; tb_ftd[i].style.width = tdwidths[i]+"%"; }tb_mtable.style.width = "100%"; tb_htable.style.width = "100%"; tb_ftable.style.width = "100%";setTimeout("tb_sep_mu_restorelayout()",1);tb_sep_drag = null;document.onmouseup	 = null;document.onmousemove = null;}}function tb_sep_mu_restorelayout () {tb_mtable.style.tableLayout = 'fixed';tb_htable.style.tableLayout = 'fixed';tb_ftable.style.tableLayout = 'fixed';tb_sep_pos();}function tb_sep_mm ( e ) {if (!e) var e = window.event;if ( tb_sep_drag ) {if ( document.selection ) { if ( document.selection.type.toLowerCase() != "none" && document.selection.empty ) document.selection.empty(); }var xpos = e.clientX-1;if ( xpos >= tb_sep_drag.minx && xpos <= tb_sep_drag.maxx ) {tb_sep_drag.divobj.style.left = xpos;} else if ( xpos < tb_sep_drag.minx ) {tb_sep_drag.divobj.style.left = tb_sep_drag.minx + 10;tb_sep_mu();} else if ( xpos < tb_sep_drag.maxx ) {tb_sep_drag.divobj.style.left = tb_sep_drag.maxx - 10;tb_sep_mu();}}}function tb_sep_pos () {for ( var i=0; i<tb_sep_divs.length; i++ ) {var pos = tb_get_obj_pos(tb_htd[i+1]);tb_sep_divs[i].style.left = pos[0]-1;tb_sep_divs[i].style.top = pos[1];}}function tb_sort( col, type ) {tb_sort_order = (tb_sort_col == col) ? !tb_sort_order : true;if ( pager ) {pnum = 1;psort = cols[col];porder = ( tb_sort_order ) ? "asc" : "desc";tb_pager();return;}AjaxDo( "tsort", "out=xml&elid="+clistfunc+"&col="+cols[col]+"&order="+(( tb_sort_order ) ? "" : "on") );var mt = tb_get_obj("MAINTBL").tBodies[0];if ( !mt || !mt.rows[0] ) return;var cc = mt.rows[0].cells.length;var ce = (mt.rows[0].className.search("even") > -1 ? 0 : 1);var ta = new Array(mt.rows.length);for ( var i=0; i<mt.rows.length; i++ ) {var inhtml = new Array();for ( var j=0; j<mt.rows[i].cells.length; j++ ) inhtml.push(mt.rows[i].cells[j].innerHTML);if(type == "alpha") {var valueCell = mt.rows[i].cells[col].innerHTML.replace(new RegExp("(\<(/?[^\>]+)\>)",'g'), '');} else if(type == "prop") {var valueCell = mt.rows[i].cells[col].innerHTML.match(/[01]{1,10}/)['0'].replace('"', '');} else {var valueCell = mt.rows[i].cells[col].innerHTML;}ta[i] = [valueCell, va[i][0], va[i][1], va[i][2], inhtml, mt.rows[i].className];}tb_row_unselect_all();if ( tb_sort_col != -1 ) tb_get_obj("sortimg"+tb_sort_col).src = "e.gif";tb_sort_col = col;if (type == "alpha") ta.sort(tb_sort_a);else if(type == "prop") ta.sort(tb_sort_p);else if (type == "digit") ta.sort(tb_sort_d);else if (type == "indicator") ta.sort(tb_sort_i);else if (type == "ip") ta.sort(tb_sort_ip);else if (type == "file") ta.sort(tb_sort_f);else { alert("Unknown sort method"); return; }if (!tb_sort_order) ta.reverse();for ( var i=0; i<ta.length; i++ ) {for ( var j=0; j<mt.rows[i].cells.length; j++ ) {mt.rows[i].cells[j].innerHTML = ta[i][4][j];}mt.rows[i].className = ta[i][5];va[i] = [ta[i][1],ta[i][2],va[i][2]];if ( i % 2 == ce ) {tb_add_class(mt.rows[i], "even");} else {tb_remove_class(mt.rows[i], "even");}}for ( var i=0; i<va.length; i++ ) {if ( va[i][1] == 1 ) tb_row_select( i, va[i][1] );}tb_get_obj("sortimg"+col).src = ( tb_sort_order ) ? "down.gif" : "up.gif";}function tb_sort_a(a, b) {if (b[0] == a[0]) return 0;if (b[0] < a[0]) return 1; else return -1;}function tb_sort_p(a, b) {a1 = a[0];b1 = b[0];return a1 - b1;}function tb_sort_d(a, b) {a1 = a[0].replace(/<[^>]*>/g, "").replace(/[^\d\.\-]/g,"");b1 = b[0].replace(/<[^>]*>/g, "").replace(/[^\d\.\-]/g,"");return a1 - b1;}function tb_sort_f(a, b) {if ( a[0].match(/src="[^"]*p-file-0/) && b[0].match(/src="[^"]*p-file-0/) ) { return tb_sort_a(a,b); }if ( a[0].match(/src="[^"]*p-file-0/) && !b[0].match(/src="[^"]*p-file-0/) ) { return -1; }if ( !a[0].match(/src="[^"]*p-file-0/) && b[0].match(/src="[^"]*p-file-0/) ) { return 1; }if ( !a[0].match(/src="[^"]*p-file-0/) && !b[0].match(/src="[^"]*p-file-0/) ) {var c = a[0].replace(/<.*?>/g,"");var d = b[0].replace(/<.*?>/g,"");if (d == c) return 0;if (d < c) return 1; else return -1;}}function tb_sort_i(a, b) {a[0].match(/(\d+)/);a1 = RegExp.$1;b[0].match(/(\d+)/);return a1 - RegExp.$1;}function tb_sort_ip(a, b) {if ( a[0].match(/\./) ) {return tb_addr4toint(a[0]) - tb_addr4toint(b[0]);} else {var astr = tb_addr6tostr(a[0]);var bstr = tb_addr6tostr(b[0]);if (astr == bstr) return 0;if (bstr < astr) return 1; else return -1;}}function tb_addr4toint ( addr ) {var ch = addr.split(".");return (((((parseInt(ch[0]) << 8) + parseInt(ch[1])) << 8) + parseInt(ch[2])) << 8) + parseInt(ch[3]);}function tb_addr6tostr ( addr ) {var resdata = new Array();var matches = addr.match(/[0-9a-f]+|::/gi);for ( var i=0; i<matches.length; i++ ) {if ( matches[i] == "::" ) {for ( var j=matches.length; j<=8; j++ ) resdata.push( "0000" );} else {val = String(matches[i]);if ( val.length < 4 ) for ( var j=matches[i].length; j<4; j++ ) val = "0" + val;resdata.push(val);}}return resdata.join(":");}function tb_add_event ( el, evname, func ) {if (el.attachEvent) {el.attachEvent("on" + evname, func);} else if (el.addEventListener) {el.addEventListener(evname, func, true);} else {el["on" + evname] = func;}}function tb_remove_event (el, evname, func) {if (el.detachEvent) {el.detachEvent("on" + evname, func);} else if (el.removeEventListener) {el.removeEventListener(evname, func, true);} else {el["on" + evname] = null;}}function tb_stop_event ( e ) {e || (e = window.event);if ( isIE2 ) { e.cancelBubble = true; e.returnValue = false; }else { e.preventDefault(); e.stopPropagation(); }return false;}function tb_remove_class ( el, name ) {if (!(el && el.className)) return;var cls = el.className.split(" ");var ar = new Array();for (var i = cls.length; i > 0;) if (cls[--i] != name) ar[ar.length] = cls[i];el.className = ar.join(" ");}function tb_add_class ( el, name ) {tb_remove_class( el, name );el.className += " " + name;}function tb_rep_countstat ( tid, totaltypes ) {var tbl = tb_get_obj(tid);if ( !tbl ) return;var htbl = tbl.tBodies[0];var ctbl = tbl.tBodies[1];var ftbl = tbl.tBodies[2];for ( var i=0; i<totaltypes.length; i++ ) {var value = "&nbsp;";if ( totaltypes[i] == "count" ) {value = ctbl.rows.length;} else if ( totaltypes[i] == "sum" ) {value = 0; fixnum = 0;for ( var j=0; j<ctbl.rows.length; j++ ) {var cval = parseFloat(ctbl.rows[j].cells[i].innerHTML);if ( String(cval).match(/\d+\.(\d+)/) ) { fixnum = ( String(RegExp.$1).length > fixnum ) ? String(RegExp.$1).length : fixnum; }value += cval;}if ( value.toFixed ) value =  value.toFixed(fixnum);} else if ( totaltypes[i] == "timesum" ) {var h = 0, m = 0, s = 0;for ( var j=0; j<ctbl.rows.length; j++ ) {var cval = ctbl.rows[j].cells[i].innerHTML.match(/(\d+):(\d\d):(\d\d)/);if (cval && cval.length) {h += parseInt(cval[0]);m += parseInt(cval[1]);s += parseInt(cval[2]);}}m += (s / 60).toFixed();s = s % 60;h += (m / 60).toFixed();m = m % 60;value = h + ":" + (m < 10 ? "0" : "") + m + ":" + (s < 10 ? "0" : "") + s;} else if ( totaltypes[i] == "avg" ) {var sum = 0;for ( var j=0; j<ctbl.rows.length; j++ ) sum += parseFloat(ctbl.rows[j].cells[i].innerHTML);value = sum / ctbl.rows.length;if ( value.toFixed ) value =  value.toFixed(2);}ftbl.rows[0].cells[i].innerHTML = value;}}function tb_sort_rep( col, type, tabID ) {tb_sort_order[tabID] = (tb_sort_col[tabID] == col) ? !tb_sort_order[tabID] : true;var mt = tb_get_obj(tabID).tBodies[1];if ( !mt || !mt.rows[0] || mt.length == 1 ) return;var cc = mt.rows[0].cells.length;var ta = new Array(mt.rows.length);var sa = new Array(mt.rows.length);for ( var i=0; i<mt.rows.length; i++ ) {var inhtml = new Array();for ( var j=0; j<mt.rows[i].cells.length; j++ ) inhtml.push(mt.rows[i].cells[j].innerHTML);ta[i] = [mt.rows[i].cells[col].innerHTML,mt.rows[i].id];}tb_sort_col[tabID] = col;if (type == "alpha" || type == "prop") ta.sort(tb_sort_a);else if (type == "digit") ta.sort(tb_sort_d);else if (type == "indicator") ta.sort(tb_sort_i);else if (type == "ip") ta.sort(tb_sort_ip);else if (type == "file") ta.sort(tb_sort_f);else { alert("Unknown sort method"); return; }if (!tb_sort_order[tabID]) ta.reverse();for ( var i=0; i<ta.length; i++ ) {sa[i] = document.getElementById(ta[i][1]).innerHTML;}for ( var i=0; i<ta.length; i++ ) {mt.rows[i].innerHTML = sa[i];}}