var isIE = ( navigator.userAgent.indexOf("MSIE") != -1 ) ? true : false;var isIE2 = ( /msie/i.test(navigator.userAgent) && !/opera/i.test(navigator.userAgent) );var fr_cf_height = 0;var fr_passwd_cnt = 0;var fr_passwd_obj = [];var fr_hint_timer = null;var fr_chheight = {};function fr_aimg ( iobj, fname, action ) {if ( action == "click" ) {eval( iobj.getAttribute("action") + "('" + fname + "')" );} else if ( action == "down" ) {iobj.src = iobj.src.replace(/(\.\w+$)/,"-a$1");} else if ( action == "up" ) {iobj.src = iobj.src.replace(/-a(\.\w+$)/,"$1");}}function fr_disabled() {document.frm.suok.value = msg_disabled;document.frm.suok.className = 'button-dis';document.frm.suok.disabled = true;}function fr_enabled() {document.frm.suok.value = frm_msg_ok;document.frm.suok.className = 'button';document.frm.suok.disabled = false;}function fr_url_open(nameobj, elemopen  ) {var url = null;var elem = document.frm.elements[nameobj];listobj = eval("top."+nameobj+"list");var val = elem.options[elem.selectedIndex].value;for ( var i=0; i< listobj.length; i++ ) {if ( listobj[i][1] == val ) {url = listobj[i][elemopen];}}window.open(url,'','');}function fr_lb_select ( nameobj, status ) {var listbox = document.frm.elements[nameobj];for ( var i=0; i<listbox.options.length; i++ ) listbox.options[i].selected = status;}function fr_depend_list ( list, listar, value, curvalue, dependindex ) {var di = ( dependindex && dependindex != "" ) ? parseInt(dependindex,10) : 2;var curvals = {};if ( curvalue ) {var curvalues = curvalue.split(/, /);for ( i=0; i<=curvalues.length; i++ ) curvals[curvalues[i]] = true;}var n = 0;list.options.length = listar.length;for ( var i=0; i<listar.length; i++ ) {if ( listar[i][di] == value || listar[i][di] == null || listar[i][di] == "" ) {list.options[n].value = listar[i][1];list.options[n].text = listar[i][0];list.options[n].selected = ( curvals[listar[i][1]] ) ? true : false;n++;}}list.options.length = n;if ( list.fireEvent ) {list.fireEvent("onchange");} else if ( list.dispatchEvent ) {var eve = list.ownerDocument.createEvent("HTMLEvents");eve.initEvent("change",false,true);list.dispatchEvent(eve);}fr_set_options_count_to_row( list, n );}function fr_set_options_count_to_row( obj, count ) {var trflag = false;while ( obj.tagName && (obj.tagName.toLowerCase() != "tr" || !trflag) && obj.parentNode ) { if ( obj.tagName.toLowerCase() == "tr" ) trflag = true; obj = obj.parentNode; }obj.setAttribute("optcount",count);if ( count == 0 ) obj.style.display = "none"; else if (!obj.getAttribute("hidden")) obj.style.display = ( isIE ) ? "block" : "table-row";}function fr_gen_passwd ( name, cname ) {if ( fr_top ) { fr_hintout(); } else { top.mn_hintout(); }var fpp = document.frm.elements[name]; if ( !fpp ) return; fpp.style.display = 'none';var fpt = document.frm.elements[name+"gen"]; if ( !fpt ) return; fpt.style.display = 'block';var fcp = document.frm.elements[cname]; if ( !fcp ) return; fcp.style.display = 'none';var fct = document.frm.elements[cname+"gen"]; if ( !fct ) return; fct.style.display = 'block';fr_passwd_obj = [0, fpp, fpt, fcp, fct];fr_gen_passwdversion();}function fr_gen_passwdversion () {var cpwd = String(fr_passwd_obj[2].value).substr(0,fr_passwd_obj[0]);var pwd = "";for ( var i=fr_passwd_obj[0]; i<top.pwgenlen; i++ ) {pwd += top.pwgencharacters.substr( Math.floor((Math.random()*top.pwgencharacters.length)), 1);}pwd = cpwd + pwd;fr_passwd_obj[1].value = pwd; fr_passwd_obj[2].value = pwd; fr_passwd_obj[3].value = pwd; fr_passwd_obj[4].value = pwd;if ( fr_passwd_obj[0] < top.pwgenlen ) {if ( fr_passwd_cnt == 1 ) {fr_passwd_obj[0] += 1;fr_passwd_cnt = 0;} else {fr_passwd_cnt += 1;}fr_passwd_obj = [fr_passwd_obj[0], fr_passwd_obj[1], fr_passwd_obj[2], fr_passwd_obj[3], fr_passwd_obj[4]];setTimeout("fr_gen_passwdversion()",35);}}function checkPassword(passwd) {var symbols = new RegExp(/[!@#$^&*()[\].,:;'"\\\/<>{}]/),lowerCase = new RegExp(/[qwertyuiopasdfghjklzxcvbnm]/),upperCase = new RegExp(/[QWERTYUIOPASDFGHJKLZXCVBNM]/),numbers = new RegExp(/\d/),minPasswdLength = 8,numCnt = false,upperCnt = false,lowerCnt = false,symbolsCnt = false,passwdArr = passwd.split(""),passwdLen = passwdArr.length;if (passwd.match(symbols)) {symbolsCnt = true;}if (passwd.match(lowerCase)) {lowerCnt = true;}if (passwd.match(upperCase)) {upperCnt = true;}if (passwd.match(numbers)) {numCnt = true;}if (numCnt && upperCnt && lowerCnt && (passwdLen >= minPasswdLength)) {return true;} else {return false;}}function fr_gen_passwd_OLD ( name, cname ) {var pwd = "";for ( var i=0; i<top.pwgenlen; i++ ) pwd += top.pwgencharacters.substr( Math.floor((Math.random()*top.pwgencharacters.length)), 1 );var fld = document.frm.elements[name]; if ( !fld ) return; fld.style.display = 'none'; fld.value = pwd;fld = document.frm.elements[name+"gen"]; if ( !fld ) return; fld.style.display = 'block'; fld.value = pwd;fld = document.frm.elements[cname]; if ( !fld ) return; fld.style.display = 'none'; fld.value = pwd;fld = document.frm.elements[cname+"gen"]; if ( !fld ) return; fld.style.display = 'block'; fld.value = pwd;}function fr_get_elem ( form, name ) {for ( var i=0; i<form.elements.length; i++ )if ( form.elements[i].name == name )return form.elements[i];return null;}function fr_get_obj ( id ) {if ( document.getElementById ) return document.getElementById(id);else if ( document.all ) return document.all[id];else return null;}function fr_get_obj_pos ( obj ) {x = 0; y = 0;while ( obj.offsetParent ) { x += obj.offsetLeft; y += obj.offsetTop; obj = obj.offsetParent; }return [x,y];}function fr_hint ( hid, e ) {if (!e) var e = window.event;if ( hid == "" ) return; if ( e == null ) return;var x = e.clientX;var y = e.clientY;hid = eval(hid);if ( !hid ) return;fr_hint_timer = setTimeout('fr_hint_show("'+hid+'",'+x+','+y+')',500);}function fr_hint_show ( hid, x, y ) {var hlayer = fr_get_obj("hintpane");var ww = ( window.innerWidth ) ? top.window.innerWidth : top.document.body.clientWidth;if ( hlayer ) {if ( hlayer.style.visibility == 'visible' ) fr_hintout();var xpos = ( x + hlayer.offsetWidth > ww ) ? x - hlayer.offsetWidth + 10 : x;var ypos = y + 22;hlayer.innerHTML = hid;hlayer.style.left = xpos;hlayer.style.top = ypos;hlayer.style.visibility = 'visible';clearTimeout(fr_hint_timer);}}function fr_hintout () {var hlayer = fr_get_obj("hintpane");if ( hlayer != null ) {hlayer.style.visibility = 'hidden';hlayer.style.top = 0;hlayer.style.left = 0;}clearTimeout(fr_hint_timer);}function fr_hs_fields ( hf, sf ) {var el = null;for ( var i=0; i<hf.length; i++ ) {el = document.getElementById(hf[i]);if ( el != null ) { el.style.display = "none"; el.setAttribute("hidden","yes"); }}if ( sf ) {for ( var i=0; i<sf.length; i++ ) {el = document.getElementById(sf[i]);if ( el != null) {el.removeAttribute("hidden");if (el.getAttribute("optcount") != "0") {if(sf[i].match('tab_')) {el.style.display = "table";} else if(isIE){el.style.display = "block";} else {el.style.display = "table-row";}}}}}fr_set_size();fr_inputfile();}function fr_hs_optional ( obj ) {var status = obj.getAttribute("optflag");var tbody = obj;while ( tbody.parentNode ) { tbody = tbody.parentNode; if ( tbody.tagName.toLowerCase() == "tbody" ) break; }for ( var i=0; i<tbody.rows.length; i++ ) {if ( tbody.rows[i].getAttribute("optional") == "yes" ) {if ( status == "show" ) {tbody.rows[i].style.display = "none";} else if ( !tbody.rows[i].getAttribute("hidden") ) {tbody.rows[i].style.display = ( isIE ) ? "block" : "table-row";}}}if ( status == "hide" ) {obj.className = "field-opta";obj.getElementsByTagName("span")[0].innerHTML = msg_hideoptional;obj.getElementsByTagName("span")[1].innerHTML = "";obj.setAttribute("optflag","show");} else {obj.className = "field-opt";obj.getElementsByTagName("span")[0].innerHTML = msg_showoptional;var notemsg = ""; try { notemsg = get_optnote(); } catch ( ex ) {}obj.getElementsByTagName("span")[1].innerHTML = notemsg;obj.setAttribute("optflag","hide");}fr_set_size( true );fr_inputfile();}function fr_init () {if ( window.fr_top ) return;top.mn_set_active( String(location.search) );top.document.getElementById("ftitle").innerHTML = window.msg_title || '';var maxh = 0;if ( (window.fr_pc || 0) > 0 ) {for ( var i=0; i<fr_pc; i++ ) {fr_pager(i);var cfh = document.getElementById("fields").offsetHeight;if ( cfh > maxh ) maxh = cfh;}fr_pager(0);} else try {maxh = document.getElementById("fields").offsetHeight;} catch(e) {}fr_cf_height = maxh;try { document.getElementById("fieldsDiv").style.height = maxh; } catch(e) {}var pch = ( document.getElementById("pcDiv") ) ? document.getElementById("pcDiv").offsetHeight : 0;var bth = ( document.getElementById("buttonsDiv") ) ? document.getElementById("buttonsDiv").offsetHeight : 0;try { top.document.getElementById("formframe").height = maxh + pch + bth; } catch(e) {}if ( window.fr_maxwidth ) {var ww = ( top.window.innerWidth ) ? top.window.innerWidth : top.document.body.clientWidth;top.mn_form_maxmin_icon("min");top.mn_get_obj("formframe").width = ww * 0.8;if ( isIE ) top.mn_form_normalize( true );} else try {top.mn_form_maxmin_icon("max");} catch(e) {}fr_inputfile();if ( fr_get_obj("optnote") ) {var notemsg = ""; try { notemsg = get_optnote(); } catch ( ex ) {}if ( notemsg != "" ) fr_get_obj("optnote").innerHTML = notemsg;}top.mn_get_obj("waitlayer").style.visibility = "hidden";setTimeout("fr_showform()",100);if(typeof touchScroll == 'function'){touchScroll('htmldata-hist');}}function fr_inputfile () {if ( !/gecko/i.test(navigator.userAgent) ) return;var inputs = document.getElementsByTagName("input");for ( var i=0; i<inputs.length; i++ ) {var elem = inputs[i];if ( elem.type != "file" ) continue;elem.className = "ffinput";elem.size = 32;var tdobj = elem.offsetParent; if ( !tdobj ) { continue; }var maxw = tdobj.offsetWidth;var csize = elem.size;var n = 200;while ( n-- ) {csize++; elem.size = csize;if ( elem.offsetWidth > maxw ) { elem.size = csize - 1; break; }}}}function fr_showform () {top.mn_get_obj("formlayer").style.visibility = "visible";var formelem = top.mn_get_obj("formelem");setTimeout("fr_setfocus()",100);}function fr_setfocus () {var fel = document.frm.elements || [];if ( fr_focus != "" ) {var elem = document.frm.elements[fr_focus].focus();if ( iserror ) { try { document.frm.elements[fr_focus].select(); } catch (eo) {} }} else {for ( var i=0; i<fel.length; i++ ) {if ( fel[i].type == "text" || fel[i].type == "password" || fel[i].type == "textarea" || fel[i].type == "select-one" || fel[i].type == "checkbox" )if ( !fel[i].disabled && !fel[i].readOnly && fel[i].style.display != "none" ) {if (document.frm.elements[fel[i].name]){setTimeout("document.frm.elements['"+fel[i].name+"'].focus()",100);break;}}}}}function fr_is_visible ( obj ) {var trflag = false;while ( obj.tagName && (obj.tagName.toLowerCase() != "tr" || !trflag) && obj.parentNode ) { if ( obj.tagName.toLowerCase() == "tr" ) trflag = true; obj = obj.parentNode; }if ( obj.style.display == "none" ) { return false; } else { return true; }}function fr_pager ( id ) {var ctbody = document.getElementById("fpage_"+id);if ( !ctbody ) return;if ( ctbody.style.display != "none" ) return;for ( var i=0; i<fr_pc; i++ ) {var temptbody = document.getElementById("fpage_"+i);if ( !temptbody ) return;temptbody.style.display = ( i != id ) ? "none" : ( isIE ) ? "block" : "table-row-group";var phead = document.getElementById("fphead_"+i);if ( !phead ) return;phead.className = ( i != id ) ? "pcontrol" : "pcontrol-a";}fr_set_size();fr_inputfile();}function fr_reg_mm ( cursortype ) {document.body.style.cursor = cursortype;document.onmousemove = fr_mm_doc; if (document.captureEvents) document.captureEvents(Event.MOUSEMOVE);document.onmouseup = fr_mu_doc; if (document.captureEvents) document.captureEvents(Event.MOUSEUP);}function fr_unreg_mm () {document.body.style.cursor = "default";document.onmousemove = null;document.onmouseup = null;}function fr_mm_doc ( e ) {if (!e) var e = window.event;e.isFormFrame = true;top.mn_mm_doc(e);}function fr_mu_doc () {top.mn_mu_doc();}function fr_set_prop ( name ) {var t_el = document.frm.elements[name];if ( !t_el ) return;var ta_el = document.frm.elements[name+"_list"];if ( !ta_el ) return;t_el.value = ta_el.value.replace(/\n+/g," ").replace(/(^\s*|\s*$)/g,"").replace(/\s+/g," ");}function fr_set_size ( min ) {if ( fr_top ) return;if ( fr_maxheight && document.getElementById(fr_maxheight) ) {var frmh = ( window.innerHeight ) ? top.window.innerHeight - 60 : top.document.body.clientHeight - 60;var cfh = document.getElementById("fields").offsetHeight;var pch = ( document.getElementById("pcDiv") ) ? document.getElementById("pcDiv").offsetHeight : 0;var bth = ( document.getElementById("buttonsDiv") ) ? document.getElementById("buttonsDiv").offsetHeight : 0;var diff = frmh - cfh - pch - bth;fr_cf_height = cfh + diff;document.getElementById("fieldsDiv").style.height = cfh + diff;var maxobj = document.getElementById(fr_maxheight);var maxobjh = maxobj.offsetHeight + diff;if ( maxobjh < 10 ) return;maxobj.style.height = maxobjh;top.document.getElementById("formframe").height = frmh;} else {var cfh = document.getElementById("fields").offsetHeight;if ( cfh > fr_cf_height || min ) {fr_cf_height = cfh;document.getElementById("fieldsDiv").style.height = cfh;var pch = ( document.getElementById("pcDiv") ) ? document.getElementById("pcDiv").offsetHeight : 0;var bth = ( document.getElementById("buttonsDiv") ) ? document.getElementById("buttonsDiv").offsetHeight : 0;top.document.getElementById("formframe").height = cfh + pch + bth;}}}function fr_zoom_field ( img, name ) {top.mn_hintout();var t_el = document.frm.elements[name];if ( t_el == null ) return;var ta_el = document.frm.elements[name+"_list"];if ( ta_el == null ) return;if ( t_el.style.display == "none" ) {t_el.value = ta_el.value.replace(/\n+/g," ").replace(/(^\s*|\s*$)/g,"").replace(/\s+/g," ");t_el.style.display = "block";ta_el.style.display = "none";img.setAttribute("cimg","ff-zoom");img.setAttribute("caimg","ff-unzoom");} else {ta_el.value = t_el.value.replace(/(^\s*|\s*$)/g,"").replace(/\s+/g,"\n");t_el.style.display = "none";ta_el.style.display = "block";img.setAttribute("cimg","ff-unzoom");img.setAttribute("caimg","ff-zoom");}fr_set_size();}function fr_md_chheight ( e, myid, hisid ) {if (!e) var e = window.event;fr_chheight.y = e.clientY;fr_chheight.myobj = document.getElementById( myid );fr_chheight.myh = fr_chheight.myobj.offsetHeight;fr_chheight.hisobj = document.getElementById( hisid );fr_chheight.hish = fr_chheight.hisobj.offsetHeight;document.onmouseup	 = fr_mu_chheight; if (document.captureEvents) document.captureEvents(Event.MOUSEUP);document.onmousemove = fr_mm_chheight; if (document.captureEvents) document.captureEvents(Event.MOUSEMOVE);fr_stop_event ( e );}function fr_mu_chheight () {document.onmouseup	 = null;document.onmousemove = null;fr_chheight = {};}function fr_mm_chheight ( e ) {if (!e) var e = window.event;var minval = 42;var diff = e.clientY - fr_chheight.y;var myh = fr_chheight.myh + diff;var hish = fr_chheight.hish - diff;if ( myh < minval ) {var ediff = minval - myh; myh += ediff; hish -= ediff;} else if ( hish < minval ) {var ediff = minval - hish; myh -= ediff; hish += ediff;}fr_chheight.myobj.style.height = myh;fr_chheight.hisobj.style.height = hish;}function fr_stop_event ( e ) {e || (e = window.event);if ( isIE2 ) { e.cancelBubble = true; e.returnValue = false; }else { e.preventDefault(); e.stopPropagation(); }return false;}function fr_quote ( tobj ) {var qstr = "";var stxt = "";if ( document.getSelection ) { stxt = document.getSelection(); }else if ( document.selection && document.selection.createRange() ) { stxt = document.selection.createRange().text; }if ( stxt == "" ) { alert(msg_noquote); return; }stxt = String(stxt).replace(/\n/g,"\n> ");var qstr = ( tobj.value == "" ) ? "> " : tobj.value + "\n> ";tobj.value = qstr + stxt;}function fr_hs_fields_report ( hf, sf ) {var el = null;for ( var i=0; i<hf.length; i++ ) {el = document.getElementById(hf[i]);if ( el != null ) el.style.display = "none";}if ( sf ) {for ( var i=0; i<sf.length; i++ ) {el = document.getElementById(sf[i]);if ( el != null ) {el.style.display = ( isIE ) ? "block" : "table-row";}}}}var fr_msgs = new Array();var fr_qtobj = null;function fr_qtemplate ( e, obj ) {e = e || window.event;fr_qtobj = ( obj ) ? obj : ( e.target ) ? e.target : e.srcElement;if ( obj || (e.keyCode == 32 && e.ctrlKey) ) {fr_stop_event ( e );var str = fr_qtobj.value;var pos = ( str.length == 0 ) ? 0 : fr_getcaretpos( fr_qtobj );var start = str.lastIndexOf('\n', pos-1)+1;var s = str.slice( start, pos );var len = s.length;s = fr_revstring(s);var sm = s.match(/(.*?)[\.\?\!] */);s = fr_revstring( (!sm) ? s : sm[1] );s = s.replace(/^ */, "");var xml = AjaxGet( "anstempl.complete", "template=" + s + "&ticket=" + document.frm.elid.value + "&out=xml", "");var x = ParseXML( xml );var messages = x.getElementsByTagName("message");if ( messages.length == 0 ) return;fr_msgs = new Array();var shtml = "<select size='5' id='stemplate' class='input' style='height:auto; width:"+fr_qtobj.offsetWidth+"px' onblur='fr_hide_qtemplate()' ondblclick='fr_insert_qtemplate()' onkeydown='fr_kdown_qtemplate(event)'>";for ( var i = 0; i<messages.length; i++ ) {fr_msgs[i] = messages[i].childNodes[0].nodeValue;shtml += "<option" + ((i==0)?" selected":"") + ">" + fr_msgs[i] + "</option>";}shtml += "</select>";var pos = fr_get_obj_pos( fr_qtobj );var hlayer = fr_get_obj("hintspace");hlayer.innerHTML = shtml;hlayer.style.left = pos[0];hlayer.style.top = pos[1];hlayer.style.visibility = 'visible';fr_get_obj("stemplate").focus();}}function fr_hide_qtemplate () {var hlayer = fr_get_obj("hintspace");hlayer.innerHTML = "";hlayer.style.visibility = 'hidden';fr_qtobj.focus();}function fr_insert_qtemplate () {var sobj = fr_get_obj("stemplate");var msg = fr_msgs[sobj.selectedIndex];fr_hide_qtemplate();var str = fr_qtobj.value;var end = ( str.length == 0 ) ? 0 : fr_getcaretpos( fr_qtobj );var start = str.lastIndexOf('\n', end-1)+1;var before = str.substring(0, start);var after = str.substring(end);fr_qtobj.value = before + msg + after;fr_qtobj.focus();}function fr_kdown_qtemplate ( e ) {e = e || window.event;if (e.keyCode == 13 ) {fr_insert_qtemplate(); return false;} else if ( e.keyCode == 27 ) {fr_hide_qtemplate(); return false;}}function fr_getcaretpos ( obj ) {obj.focus();if ( obj.selectionStart ) {return obj.selectionStart;} else if (document.selection) {var sel = document.selection.createRange();var clone = sel.duplicate();sel.collapse(true);clone.moveToElementText(obj);clone.setEndPoint('EndToEnd', sel);return clone.text.length;}return 0;}function fr_revstring ( str ) {var retStr = "";for ( var i=str.length-1; i > -1; i-- ) { retStr += str.substr(i,1); }return retStr;}